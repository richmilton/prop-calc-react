(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t){var a=String.fromCharCode(37);e.exports={formTypes:{NUMBER:"number",TEXT:"text",CHECKBOX:"checkbox",SELECT:"select",EMAIL:"email"},currencyPlaceholder:"##CURR##",percentSign:a,toastPlaceHolder:"##LABEL##"}},34:function(e,t,a){e.exports=a(63)},58:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(6),o=a.n(r),s=a(17),c=a(21),i=a(14),u=a(15),d=a(5),m=a.n(d),p=a(18),f=a(8),h=a(11),y=a(9),b=a(4),g=a(12),v=a(2),E=a(31),S=function(e,t,a,n){var l=[{label:"Yes",onClick:t},{label:"No",onClick:function(){return!1}}];a&&(l[2]={label:a,onClick:n}),Object(E.confirmAlert)({message:e,buttons:l})},w=a(1),k=new RegExp(w.currencyPlaceholder,"g"),T=function(e,t){var a=String.fromCharCode(t);return e.replace(k,a)};function C(e){var t=e.name,a=e.doLabelClass,n=e.dynamicLabel,r=e.label,o=e.type,s=e.currency,c=T(r,s);return l.a.createElement("div",{className:"checkbox"===o?"checkbox-label":"input-label"},l.a.createElement("label",{htmlFor:t,className:a?a(t):t},n?n(t,c):r))}var N={Input:function(e){var t=e.className,a=e.name,n=e.type,r=e.onInput,o=e.placeholder,s=e.label,c=e.defVal,i=e.doLabelClass,u=e.dynamicLabel,d=e.currency,m=e.required,p=e.disabled,f=e.tooltip,h=T(s,d);return l.a.createElement("li",{key:a},l.a.createElement("input",{className:t||"form-control",key:a,type:n,name:a,id:a,onChange:function(e){return r(e)},autoComplete:"off",placeholder:o||h||"".concat(a," [").concat(n,"]"),value:c||"",checked:"yes"===c,required:m||!1,disabled:p,title:f||h}),C({name:a,doLabelClass:i,dynamicLabel:u,label:s,type:n,currency:d}))},Select:function(e){var t=e.className,a=e.name,n=e.type,r=e.onInput,o=e.label,s=e.defVal,c=e.options,i=e.doLabelClass,u=e.dynamicLabel,d=e.disabled,m=e.tooltip;return l.a.createElement("li",{key:a},l.a.createElement("select",{value:s,className:t||"form-control",key:a,name:a,id:a,onChange:function(e){return r(e)},disabled:d,title:m||""},c.map(function(e){return l.a.createElement("option",{key:e.value,name:e.name,value:e.value},e.name)})),C({name:a,doLabelClass:i,dynamicLabel:u,label:o,type:n}))}},F=N.Input,x=N.Select;function O(e){var t=e.render,a=e.fields,n=e.className;return l.a.createElement("ul",{className:n},t(a))}var L=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(h.a)(this,Object(y.a)(t).call(this,e))).doLabel=a.doLabel.bind(Object(v.a)(Object(v.a)(a))),a.doLabelClass=a.doLabelClass.bind(Object(v.a)(Object(v.a)(a))),a.renderFields=a.renderFields.bind(Object(v.a)(Object(v.a)(a))),a.renderFieldCols=a.renderFieldCols.bind(Object(v.a)(Object(v.a)(a))),a.handleChange=a.handleChange.bind(Object(v.a)(Object(v.a)(a))),a.handleSave=a.handleSave.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){(0,this.props.calculate)()}},{key:"doLabel",value:function(e,t){var a=this.props.formData;return a&&a[e]?t||e:""}},{key:"doLabelClass",value:function(e){var t=this.props.formData;return t&&t[e]?"show":"hide"}},{key:"handleChange",value:function(e){var t,a=e.type,n=e.value,l=e.checked,r=e.name,o=this.props;switch(a){case w.formTypes.NUMBER:t=Number.isNaN(n)?0:Number.parseFloat(n)||0;break;case w.formTypes.CHECKBOX:t=l?"yes":"no";break;default:t=n||""}o.calculate(r,t)}},{key:"handleSave",value:function(e){e.preventDefault(),(0,this.props.onsave)(),e.target.blur()}},{key:"renderFields",value:function(e){var t=this,a=[],n=this.props,l=n.currsymbol,r=n.formData,o=function(e){var t=e.regex,a=e.whenField;return t.test(r[a])};return e.forEach(function(e){var n=Object(u.a)({},e);n.dynamicLabel=function(e,a){return t.doLabel(e,a)},n.doLabelClass=function(e){return t.doLabelClass(e)},n.onInput=function(e){return t.handleChange(e.target)},n.onblur=function(e){return t.handleChange(e.target)},n.currency=l,n.defVal=r[n.name],n.disabled=n.disabled&&n.disabled.some(o),"select"===n.type?a.push(x(n)):a.push(F(n))}),a}},{key:"renderFieldCols",value:function(){var e=this.props.fields,t=Math.floor(e.length/2),a=e.slice(0),n=a.splice(t);return[l.a.createElement(O,{key:"1",fields:a,className:"left",render:this.renderFields}),l.a.createElement(O,{key:"2",fields:n,className:"right",render:this.renderFields})]}},{key:"render",value:function(){var e=this.props,t=e.name,a=e.twocols,n=e.fields,r=e.showsave?l.a.createElement("ul",{className:"left"},l.a.createElement("li",null,l.a.createElement("button",{type:"submit",className:"btn-primary form-control",onClick:this.handleSave},"save this"))):"";return l.a.createElement("form",{name:t,id:t},"yes"===a?this.renderFieldCols():this.renderFields(n),r)}}]),t}(n.Component),j=[{label:"Project name",name:"projectName",type:w.formTypes.TEXT,defVal:"",required:!0,tooltip:"used as reference when saving"},{label:"Post code",name:"postCode",type:w.formTypes.TEXT,defVal:"",required:!0,tooltip:"a valid UK postcode will show links panel in results section"},{label:"Asking price(".concat(w.currencyPlaceholder,")"),name:"askingPrice",type:w.formTypes.NUMBER,defVal:0,tooltip:"for reference only: not used in calculations"},{label:"Purchase price(".concat(w.currencyPlaceholder,")"),name:"propertyValue",type:w.formTypes.NUMBER,defVal:0,tooltip:"price you intend paying for property: will be used in deal finance and stamp duty calculation"},{label:"Done up value/GDV(".concat(w.currencyPlaceholder,")"),name:"doneUpValue",type:w.formTypes.NUMBER,defVal:0,tooltip:"market value after completing works: used to calculate buy to let section"},{label:"Initial LTV(".concat(w.percentSign,")"),name:"initialLoanToValue",type:w.formTypes.NUMBER,defVal:75,disabled:[{whenField:"buyingCash",regex:/yes/}],tooltip:"used to calculate deal finance mortgage advance and deposit"},{label:"Mortgage fee(".concat(w.currencyPlaceholder,")"),name:"initMortgageFee",type:w.formTypes.NUMBER,defVal:0,disabled:[{whenField:"buyingCash",regex:/yes/}],tooltip:"included in deal finance professional fees"},{label:"Surveyors fee(".concat(w.currencyPlaceholder,")"),name:"initSurveyorsFee",type:w.formTypes.NUMBER,defVal:600,tooltip:"included in deal finance professional fees"},{label:"Cash purchase",name:"buyingCash",type:w.formTypes.CHECKBOX,defVal:"no"},{label:"Mortgage term",name:"mortgageTerm",type:w.formTypes.NUMBER,defVal:25,disabled:[{whenField:"buyingCash",regex:/yes/}],tooltip:"used in deal finance repayment mortgage calculation"},{label:"Legal fees(".concat(w.currencyPlaceholder,")"),name:"initLegalFee",type:w.formTypes.NUMBER,defVal:1500,tooltip:"included in deal finance professional fees"},{label:"Stamp duty type",name:"stampDutyType",type:w.formTypes.SELECT,options:[{value:"residential",name:"Residential"},{value:"commercial",name:"Commercial"}],defVal:"residential",tooltip:"what kind of property are you buying"},{label:"Stamp duty region",name:"stampDutyRegion",type:w.formTypes.SELECT,options:[{value:"england",name:"England/NI"},{value:"scotland",name:"Scotland"},{value:"wales",name:"Wales"},{value:"ireland",name:"Ireland"}],defVal:"england",tooltip:"where is it"},{label:"Stamp duty buyer",name:"stampDutyBuyer",type:w.formTypes.SELECT,options:[{value:"investor",name:"Investor"},{value:"first",name:"First time buyer"},{value:"home",name:"Moving house"}],defVal:"investor",disabled:[{whenField:"stampDutyType",regex:/commercial/}],tooltip:"what kind of buyer are you"},{label:"Monthly rent(".concat(w.currencyPlaceholder,")"),name:"monthlyRent",type:w.formTypes.NUMBER,defVal:0,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}],tooltip:"used for but to let calculation"},{label:"Deal type",name:"dealType",type:w.formTypes.SELECT,options:[{value:"btl&flip",name:"Buy to let and flip"},{value:"btl",name:"Buy to let"},{value:"flip",name:"Flip"},{value:"home",name:"Home only"}],defVal:"btl&flip",tooltip:"what kind of purchase are you interested in"},{label:"Refurbishment cost(".concat(w.currencyPlaceholder,")"),name:"refurbCost",type:w.formTypes.NUMBER,defVal:0,tooltip:"used in deal finance and buy to let money in and yield calculations"},{label:"Other cost(".concat(w.currencyPlaceholder,")"),name:"otherCost",type:w.formTypes.NUMBER,defVal:0,tooltip:"used in deal finance and buy to let money in and yield calculations"},{label:"Remortgage fee(".concat(w.currencyPlaceholder,")"),name:"remortgageFee",type:w.formTypes.NUMBER,defVal:0,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}],tooltip:"included in buy to let remortgage fees"},{label:"Remortgage valuation fee(".concat(w.currencyPlaceholder,")"),name:"remortgageValuationFee",type:w.formTypes.NUMBER,defVal:0,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}],tooltip:"included in buy to let remortgage fees"},{label:"Remortgage legal fees(".concat(w.currencyPlaceholder,")"),name:"remortgageLegalFee",type:w.formTypes.NUMBER,defVal:0,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}],tooltip:"included in buy to let remortgage fees"},{label:"Letting agents rate(".concat(w.percentSign,")"),name:"agentsPercent",type:w.formTypes.NUMBER,defVal:10,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/},{whenField:"repairingLease",regex:/yes/}],tooltip:"used in free cash flow calculation"},{label:"\n    MOE rate(".concat(w.percentSign,")"),name:"moePercent",type:w.formTypes.NUMBER,defVal:15,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/},{whenField:"repairingLease",regex:/yes/}],tooltip:"used in free cash flow calculation"},{label:"Repairing lease",name:"repairingLease",type:w.formTypes.CHECKBOX,defVal:"no",disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}]},{label:"Interest rate(".concat(w.percentSign,")"),name:"mortgageInterestRatePercent",type:w.formTypes.NUMBER,defVal:6,tooltip:"used in both deal finance and buy to let remortgage calculations"},{label:"Remortgage LTV(".concat(w.percentSign,")"),name:"loanToValue",type:w.formTypes.NUMBER,defVal:75,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}],tooltip:"used in buy to let remortgage calculations"},{label:"Solicitors selling fee(".concat(w.currencyPlaceholder,")"),name:"sellingLegalFee",type:w.formTypes.NUMBER,defVal:0,disabled:[{whenField:"dealType",regex:/^((?!flip).)*$/}],tooltip:"included in flip selling costs"},{label:"Agent/selling fee(".concat(w.currencyPlaceholder,")"),name:"agentSellingFee",type:w.formTypes.NUMBER,defVal:0,disabled:[{whenField:"dealType",regex:/^((?!flip).)*$/}],tooltip:"included in flip selling costs"},{label:"Mortgage stress test(".concat(w.percentSign,")"),name:"mortgageStressMultipePercent",type:w.formTypes.NUMBER,defVal:125,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}],tooltip:"used only for stress test calculations"},{label:"Stress interest rate(".concat(w.percentSign,")"),name:"mortgageStressInterestRatePercent",type:w.formTypes.NUMBER,defVal:5,disabled:[{whenField:"dealType",regex:/^((?!btl).)*$/}],tooltip:"used only for stress test calcualtions"}],R=(a(58),a(32)),M=a.n(R),P=function(e){var t=e.split("#")[1]||e;return M()("dd/MM hh:mm:ss",new Date(parseInt(t,0)))},I=function(e,t){e.preventDefault(),e.target.blur(),t(e.target.id.split("-")[1])},V=function(e){var t=e.label,a=e.value,n=e.ondelete,r=e.onclick,o=e.deletable,s=e.firstname,c=l.a.createElement("div",{className:"remove-state"},l.a.createElement("button",{className:"btn-sm btn-primary btn-warning",type:"submit",id:"delete-".concat(a),onClick:function(e){return I(e,n)},style:{display:o?"":"none"}},"delete"));return l.a.createElement("li",null,l.a.createElement("div",{className:"state ".concat(o?"deletable":"")},l.a.createElement("button",{className:"btn-primary form-control",style:{width:"100%"},type:"submit",id:"select-".concat(a),onClick:function(e){return I(e,r)}},"".concat(t," (").concat(P(a)).concat(o?"":" ".concat(s),")"))),o?c:"")},D=function(e){var t=e.data,a=e.ondelete,n=e.onselect,r=e.onclick,o=e.useremail,s=e.filter;if(t.map){var c=t.filter(s);return l.a.createElement("ul",null,c.map(function(e,t){var s=e.projectName,c=e.id,i=e.email,u="li-".concat(c,"-").concat(t);return l.a.createElement(V,{ondelete:a,key:"li-".concat(u),label:s||"untitled",value:c,onselect:n,onclick:r,deletable:o===i,firstname:i.split("@")[0].split(".")[0]})}))}return""},B=function(e){var t=e.label,a=e.value;return l.a.createElement("li",null,l.a.createElement("div",{className:"label"},t),l.a.createElement("div",{className:"value"},a))},U=function(e){var t=e.data,a=e.id;return t?l.a.createElement("ul",null,t.map(function(e,t){var n=e.label,r=e.value,o="li-".concat(a,"-").concat(t);return l.a.createElement(B,{key:"li-".concat(o),label:n,value:r})})):""},A=/^(GIR[ ]?0AA|((AB|AL|B|BA|BB|BD|BH|BL|BN|BR|BS|BT|CA|CB|CF|CH|CM|CO|CR|CT|CV|CW|DA|DD|DE|DG|DH|DL|DN|DT|DY|E|EC|EH|EN|EX|FK|FY|G|GL|GY|GU|HA|HD|HG|HP|HR|HS|HU|HX|IG|IM|IP|IV|JE|KA|KT|KW|KY|L|LA|LD|LE|LL|LN|LS|LU|M|ME|MK|ML|N|NE|NG|NN|NP|NR|NW|OL|OX|PA|PE|PH|PL|PO|PR|RG|RH|RM|S|SA|SE|SG|SK|SL|SM|SN|SO|SP|SR|SS|ST|SW|SY|TA|TD|TF|TN|TQ|TR|TS|TW|UB|W|WA|WC|WD|WF|WN|WR|WS|WV|YO|ZE)(\d[\dA-Z]?[ ]?\d[ABD-HJLN-UW-Z]{2}))|BFPO[ ]?\d{1,4})$/,H=function(e){return A.test(e.toUpperCase())},W={rmBuy:{commercial:"https://www.rightmove.co.uk/commercial-property-for-sale/search.html?radius=0.25&includeSSTC=true&searchLocation=",residential:"https://www.rightmove.co.uk/property-for-sale/search.html?radius=0.25&includeSSTC=true&searchLocation="},rmRent:{commercial:"https://www.rightmove.co.uk/commercial-property-to-let/search.html?radius=0.25&includeLetAgreed=true&searchLocation=",residential:"https://www.rightmove.co.uk/property-to-rent/search.html?radius=0.25&includeLetAgreed=true&searchLocation="},nhpSold:"https://nethouseprices.com/house-prices/",zooSold:"https://www.zoopla.co.uk/house-prices/",otmSold:"https://www.onthemarket.com/uk-house-prices/?property-type-prices=any&search-type=prices&sold-in=all-years&tenure=any&sold-prices-input=",gMap:"https://www.google.com/maps/place/"};function G(e){var t=e.href,a=e.text;return l.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:t},a)}var $=function(e){var t=e.postCode,a=e.askingPrice,n=e.monthlyRent,r=e.propertyValue,o=e.stampDutyType.startsWith("commercial")?"commercial":"residential",s=1e3,c=1e5,i=Math.ceil((a||r||4e5)/c*1.2)*c,u=Math.ceil((n||s)/s*1.2)*s;return t&&H(t)?l.a.createElement(l.a.Fragment,null,"sold prices:"," ",l.a.createElement(G,{href:W.nhpSold+t,text:"NHP"}),":",l.a.createElement(G,{href:W.zooSold+t,text:"Zoopla"}),":",l.a.createElement(G,{href:W.otmSold+t,text:"OTM"})," | ",l.a.createElement(G,{href:"".concat(W.rmBuy[o]+t,"&maxPrice=").concat(i),text:"for sale"})," | ",l.a.createElement(G,{href:"".concat(W.rmRent[o]+t,"&maxPrice=").concat(u),text:"to let"})," | ",l.a.createElement(G,{href:W.gMap+t,text:"gmap"})):l.a.createElement("span",{style:{color:"red",fontStyle:"italic"}},"use a full valid post code to see links here")};var K=function(e){var t=e.data,a=e.currentState,n=e.currency,r=e.currentState,o=r.postCode,s=r.dealType,c=t.dealFinance,i=t.buyToLet,u=t.stress,d=t.flip,m=/btl/.test(s),p=/flip/.test(s),f=String.fromCharCode(n);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"res-block",style:{display:H(o)?"":"none"}},l.a.createElement("h6",null,"Links for this post code"),$(a)),l.a.createElement("div",{className:"res-block"},l.a.createElement("h6",null,"Deal finance (".concat(f,")")),l.a.createElement(U,{id:"1",data:c})),l.a.createElement("div",{className:"res-block",style:{display:m?"":"none"}},l.a.createElement("h6",null,"Buy to let (".concat(f,")")),l.a.createElement(U,{id:"2",data:i||""})),l.a.createElement("div",{className:"res-block",style:{display:m?"":"none"}},l.a.createElement("h6",null,"Stress test (".concat(f,")")),l.a.createElement(U,{id:"3",data:u||""})),l.a.createElement("div",{className:"res-block",style:{display:p?"":"none"}},l.a.createElement("h6",null,"Flip (".concat(f,")")),l.a.createElement(U,{id:"4",data:d})))},X=a(10),q=a.n(X),Y=function(e,t,a,n,l,r,o,s,c){return e+t+a+n+l+q.a.calculate(r,o,s,c).tax+r},J=["Remortgage advance","Remortgage deposit","Remortgage fees","Money in","Money out","Money left in","Monthly rental","Monthly mortgage payment","MOE","Letting agent fees","Monthly free cashflow","Gross yield"],z=["Mortgage advance","Deposit","Stamp duty","Professional fees","Refurb/other costs","Total money in","Total cost","Interest only mortgage","Repayment mortgage","Repayment term"],Z=["Sale price","Selling costs","Total input costs","Profit (before tax)","Gain(%)"],Q=["Stress test","Minimum rent"],_=String.fromCharCode(37),ee={freeCash:function(e){var t=e.loanToValue,a=e.propertyValue,n=e.doneUpValue,l=e.mortgageInterestRatePercent,r=e.monthlyRent,o=e.moePercent,s=e.agentsPercent,c=e.refurbCost,i=e.otherCost,u=e.stampDutyType,d=e.stampDutyRegion,m=e.stampDutyBuyer,p=e.remortgageFee,f=e.remortgageValuationFee,h=e.remortgageLegalFee,y=e.initMortgageFee,b=e.initLegalFee,g=e.initSurveyorsFee,v=e.repairingLease,E="yes"===v,S=t/100,w=Math.round(n*S),k=Math.round(n*(1-S)),T=Math.round(w*l/1200),C=E?0:r*o/100,N=E?0:r*s/100,F=r-("yes"===v?0:C)-T-N,x=p+f+h,O=y+b+g+(c+i)+q.a.calculate(a,u,d,m).tax+a,L=1200*r/O,j=J;return[{label:j[0],value:w.toFixed(2)},{label:j[1],value:k.toFixed(2)},{label:j[2],value:x.toFixed(2)},{label:j[3],value:O.toFixed(2)},{label:j[4],value:(w-x).toFixed(2)},{label:j[5],value:(O-(w-x)).toFixed(2)},{label:j[6],value:r.toFixed(2)},{label:j[7],value:T.toFixed(2)},{label:j[8],value:C.toFixed(2)},{label:j[9],value:N.toFixed(2)},{label:j[10],value:F.toFixed(2)},{label:j[11],value:L.toFixed(2)+_}]},initialFinance:function(e){var t,a,n=e.buyingCash,l=e.initialLoanToValue,r=e.mortgageInterestRatePercent,o=e.propertyValue,s=e.initSurveyorsFee,c=e.initLegalFee,i=e.initMortgageFee,u=e.refurbCost,d=e.otherCost,m=e.stampDutyType,p=e.stampDutyRegion,f=e.stampDutyBuyer,h=e.mortgageTerm,y="yes"===n,b=l/100,g=y?0:Math.round(o*b),v=Math.round(g*r/1200),E=(a=h,(t=r)/100/12*g/(1-Math.pow(1+t/100/12,12*-a))),S=s+c+i,w=u+d,k=y?o:Math.round(o*(1-b)),T=q.a.calculate(o,m,p,f).tax,C=Y(s,c,i,u,d,o,m,p,f),N=C-g,F=z;return[{label:F[0],value:g.toFixed(2)},{label:F[1],value:k.toFixed(2)},{label:F[2],value:T.toFixed(2)},{label:F[3],value:S.toFixed(2)},{label:F[4],value:w.toFixed(2)},{label:F[5],value:N.toFixed(2)},{label:F[6],value:C.toFixed(2)},{label:F[7],value:"".concat(v.toFixed(2)," pcm")},{label:F[8],value:"".concat(E.toFixed(2)," pcm")},{label:F[9],value:"".concat(h," years")}]},flip:function(e){var t=e.sellingLegalFee,a=e.agentSellingFee,n=e.initSurveyorsFee,l=e.initLegalFee,r=e.initMortgageFee,o=e.refurbCost,s=e.otherCost,c=e.propertyValue,i=e.stampDutyType,u=e.stampDutyRegion,d=e.stampDutyBuyer,m=e.doneUpValue,p=Y(n,l,r,o,s,c,i,u,d),f=t+a,h=Math.round((m-p)/p*1e4)/100,y=h>=20?"green":"red",b=Z;return[{label:b[0],value:m.toFixed(2)},{label:b[1],value:f.toFixed(2)},{label:b[2],value:p.toFixed(2)||"0"},{label:b[3],value:(m-(p+f)).toFixed(2)||"0",col:y},{label:b[4],value:h.toFixed(2)||0,col:y}]},allInputCosts:Y,stressTest:function(e){var t=e.doneUpValue,a=e.monthlyRent,n=e.loanToValue,l=e.mortgageStressInterestRatePercent,r=e.mortgageStressMultipePercent,o=Math.ceil(t*n/100*l/1200*r/100),s=a>=o,c=Q;return[{label:c[0],value:s?"pass":"fail"},{label:c[1],value:o.toFixed(2)}]},getCurrencyCode:function(e){return"ireland"===e.stampDutyRegion?8364:163}},te={label:"User",name:"userEmail",type:w.formTypes.EMAIL,defVal:"",required:!0},ae=te.name,ne=te.type,le=te.label,re=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(h.a)(this,Object(y.a)(t).call(this,e))).state={email:""},a.handleChange=a.handleChange.bind(Object(v.a)(Object(v.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(b.a)(t,[{key:"handleChange",value:function(e){this.setState({email:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this.props.doLogin,a=this.state.email;e.preventDefault(),a&&t(a)}},{key:"render",value:function(){return l.a.createElement("div",{className:"column",style:{textAlign:"center"}},l.a.createElement("form",{onSubmit:this.handleSubmit},l.a.createElement("input",{className:"form-control",key:ae,type:ne,name:ae,id:ae,autoComplete:"off",placeholder:"".concat(le," [").concat(ne,"]"),onChange:this.handleChange,onBlur:this.handleChange,required:!0}),l.a.createElement("button",{type:"submit",className:"btn-primary form-control"},"go")))}}]),t}(n.Component);var oe=function(e){var t=e.doLogout;return l.a.createElement("button",{type:"submit",className:"",onClick:function(e){e.preventDefault(),t()}},"logoff")},se={unrecognisedUser:{message:"You need to be whitelisted to use the view and save functions.\n          You can still use the app to perform calculations which can be printed,\n          if you want to save copies. If you think you should be whitelisted,\n          check the email address and try logging in again, or contact your administrator",options:{appearance:"warning",autoDismissTimeout:1e4}},dataRetrieved:{message:"proposal data refreshed",options:{appearance:"success"}},noneSaved:{message:"you have no saved proposal data",options:{appearance:"info"}},dataRetrievalError:{message:"something went wrong retrieving proposal data",options:{appearance:"error"}},savedSuccess:{message:"new version of ".concat(w.toastPlaceHolder," saved successfully"),options:{appearance:"success"}},saveError:{message:"something went wrong saving new version of ".concat(w.toastPlaceHolder),options:{appearance:"error"}},deleteSuccess:{message:"".concat(w.toastPlaceHolder," deleted successfully"),options:{appearance:"success"}},deleteError:{message:"something went wrong deleting ".concat(w.toastPlaceHolder),options:{appearance:"error"}},login:{message:"logged in as ".concat(w.toastPlaceHolder),options:{appearance:"success"}},logout:{message:"logged out",options:{appearance:"success"}},loaded:{message:"".concat(w.toastPlaceHolder," loaded successfully"),options:{appearance:"success"}}},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).every(function(a){return e[a]===t[a]})},ie=(a(61),a(3),N.Input),ue="https://ww69n8b5kk.execute-api.eu-west-2.amazonaws.com/dev/comparisons",de=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(h.a)(this,Object(y.a)(t).call(this,e))).state={data:{dealFinance:[],buyToLet:[],stress:[],flip:[]},currency:163,savedStates:{Items:[]},currentState:{projectName:""},hasWorkingAPI:!1,userEmail:e.cookies.get("email")||"",showInput:!0,showResults:!0,showSaved:!0},a.topRef=l.a.createRef(),a.calculate=a.calculate.bind(Object(v.a)(Object(v.a)(a))),a.saveState=a.saveState.bind(Object(v.a)(Object(v.a)(a))),a.deleteState=a.deleteState.bind(Object(v.a)(Object(v.a)(a))),a.selectState=a.selectState.bind(Object(v.a)(Object(v.a)(a))),a.login=a.login.bind(Object(v.a)(Object(v.a)(a))),a.logout=a.logout.bind(Object(v.a)(Object(v.a)(a))),a.toastIt=a.toastIt.bind(Object(v.a)(Object(v.a)(a))),a.checkSaveOrAbortChanges=a.checkSaveOrAbortChanges.bind(Object(v.a)(Object(v.a)(a))),a.tabLink=a.tabLink.bind(Object(v.a)(Object(v.a)(a))),a.selectTab=a.selectTab.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(b.a)(t,null,[{key:"setDefaultFormData",value:function(){var e={};return j.map(function(t){return e[t.name]=t.defVal,!1}),e}}]),Object(b.a)(t,[{key:"componentDidMount",value:function(){""!==this.state.userEmail&&this.getSavedStates(!0)}},{key:"getSavedStates",value:function(e){var t=this;(function(){var a=Object(p.a)(m.a.mark(function a(){var n,l,r,o,s;return m.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=function(e,t){var a=e.projectName,n=e.id,l=t.projectName,r=t.id;return a+n<l+r?-1:a+n>l+r?1:0},l=t.state.userEmail,r=null,o=e,a.prev=4,a.next=7,fetch("".concat(ue,"/user/").concat(l));case 7:if(200!==(s=a.sent).status){a.next=15;break}return a.next=11,s.json();case 11:(r=a.sent).Items.length>0?(r.Items.sort(n),t.toastIt(se.dataRetrieved)):t.toastIt(se.noneSaved),a.next=16;break;case 15:403===s.status?t.toastIt(se.unrecognisedUser):(o=!0,t.toastIt(se.dataRetrievalError));case 16:a.next=22;break;case 18:a.prev=18,a.t0=a.catch(4),o=!0,t.toastIt(se.dataRetrievalError);case 22:return a.prev=22,t.loadState(r,o),a.finish(22);case 25:case"end":return a.stop()}},a,null,[[4,18,22,25]])}));return function(){return a.apply(this,arguments)}})()(e).then(function(){return{getSavedStates:"finished"}})}},{key:"toastIt",value:function(e,t){var a=e.message,n=e.options;this.props.toastManager.add(a.replace(w.toastPlaceHolder,t),n)}},{key:"findState",value:function(e){return this.state.savedStates.Items.find(function(t){return t.id===e})}},{key:"loadState",value:function(e,a){var n=this.state.userEmail,l={savedStates:e||{Items:[]},hasWorkingAPI:!!e};a&&(l.currentState=t.setDefaultFormData()),n&&l.currentState&&(l.currentState.email=n),this.setState(l)}},{key:"calculate",value:function(e,t){var a=this.state.currentState,n=e?Object(u.a)({},a,Object(i.a)({},e,t)):a,l=ee.initialFinance(n),r=ee.freeCash(n),o=ee.flip(n),s=ee.stressTest(n),c=ee.getCurrencyCode(n);document.getElementById("doc-title").text=n.projectName.replace(/ /g,"-");var d={data:{dealFinance:l,buyToLet:r,stress:s,flip:o},currency:c};e&&(d.currentState=n),this.setState(d)}},{key:"saveState",value:function(){var e=this;(function(){var t=Object(p.a)(m.a.mark(function t(){var a,n,l,r,o,s,c,i;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state,n=a.currentState,l=a.currentState,r=l.projectName,o=l.postCode,s=a.userEmail,""!==r&&""!==o){t.next=3;break}return t.abrupt("return");case 3:return c=Object(u.a)({},n,{email:s}),t.prev=4,t.next=7,fetch(ue,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(c)});case 7:return i=t.sent,t.next=10,i.json();case 10:e.toastIt(se.savedSuccess,r),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),e.toastIt(se.saveError,r);case 16:return t.prev=16,e.getSavedStates(!1),t.finish(16);case 19:case"end":return t.stop()}},t,null,[[4,13,16,19]])}));return function(){return t.apply(this,arguments)}})()().then(function(){return{saveState:"finished"}})}},{key:"deleteState",value:function(e){var t=this,a=this.findState(e).projectName,n="do you really want to delete '".concat(a,"' created ").concat(P(e));S(n,function(){var n=!1;(function(){var e=Object(p.a)(m.a.mark(function e(l){var r,o;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state.userEmail,e.prev=1,e.next=4,fetch(ue,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:l,email:r})});case 4:200===e.sent.status&&(o=t.state.currentState,n=o===l,t.toastIt(se.deleteSuccess,a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t.toastIt(se.deleteError,a);case 11:return e.prev=11,t.getSavedStates(n),e.finish(11);case 14:case"end":return e.stop()}},e,null,[[1,8,11,14]])}));return function(t){return e.apply(this,arguments)}})()(e).then(function(){return{delete:"finished"}})})}},{key:"selectState",value:function(e){var t=this;this.checkSaveOrAbortChanges(function(){var a=t.findState(e);t.setState({currentState:a,showInput:!0},function(){var e=t.state.currentState.projectName;t.toastIt(se.loaded,e),t.calculate(),window.scrollTo({top:t.topRef,left:0,behavior:"smooth"})})})}},{key:"checkSaveOrAbortChanges",value:function(e){var t=this,a=this.state,n=a.currentState,l=a.currentState,r=l.projectName,o=l.id,s=""!==r&&!ce(n,this.findState(o)),c="'".concat(r,"' data has changed, changes will be lost, do you want to continue?");s?S(c,e,"Save new version and continue",function(){t.saveState(),e()}):e()}},{key:"handleNew",value:function(e){var a=this;this.checkSaveOrAbortChanges(function(){e.preventDefault(),a.setState({currentState:t.setDefaultFormData()},function(){return a.calculate()})}),e.target.blur()}},{key:"login",value:function(e){var t=this;this.props.cookies.set("email",e,{path:"/"}),this.setState({userEmail:e},function(){t.toastIt(se.login,e),t.getSavedStates(!0)})}},{key:"tabLink",value:function(e){e.preventDefault();var t=e.target.id;this.setState({selectedTab:t})}},{key:"logout",value:function(){var e=this;this.props.cookies.set("email","",{path:"/"}),this.setState({userEmail:""},function(){e.toastIt(se.logout)})}},{key:"selectTab",value:function(e){var t=e.target,a=t.name,n=t.checked;this.setState(Object(i.a)({},a,n))}},{key:"render",value:function(){var e=this,t=this.state,a=t.currency,n=t.savedStates,r=t.currentState,o=t.hasWorkingAPI,s=t.error,c=t.userEmail,i=t.showInput,u=t.showResults,d=t.showSaved,m=r.projectName,p=r.postCode,f=o&&""!==m&&""!==p,h=n.Items,y=c.split("@")[1],b=h.length>0&&c?l.a.createElement(l.a.Fragment,null,l.a.createElement(D,{data:h,ondelete:this.deleteState,onclick:this.selectState,useremail:c,filter:function(e){return e.email===c},doLogin:this.login}),l.a.createElement("h6",null,"Other saved stuff from"," ".concat(y)),l.a.createElement(D,{data:h,ondelete:this.deleteState,onclick:this.selectState,useremail:c,filter:function(e){return e.email!==c}})):l.a.createElement("div",{style:{float:"left"}},se.unrecognisedUser.message),g=""!==r.projectName?l.a.createElement("ul",{className:"right"},l.a.createElement("li",null,l.a.createElement("button",{type:"submit",className:"btn-primary form-control",onClick:function(t){return e.handleNew(t)}},"new"))):"";return Object.keys(r).length>1&&c?l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"d-flex flex-wrap"},l.a.createElement("div",{className:"column"},l.a.createElement("h5",null,"Property investment deal analyser")),l.a.createElement("div",{className:"column"},l.a.createElement("ul",{className:"display-options"},l.a.createElement("li",{className:"do-label"},"show:"),l.a.createElement(ie,{style:{float:"left"},name:"showInput",label:"input",defVal:i?"yes":"no",type:"checkbox",onInput:this.selectTab,placeholder:"",required:!1}),l.a.createElement(ie,{style:{float:"left"},name:"showResults",defVal:u?"yes":"no",label:"results",type:"checkbox",onInput:this.selectTab,placeholder:"",required:!1}),l.a.createElement(ie,{style:{float:"left"},name:"showSaved",defVal:d?"yes":"no",label:"saved",type:"checkbox",onInput:this.selectTab,placeholder:"",required:!1})))),l.a.createElement("div",{className:"column input-form",style:{display:i?"":"none"}},l.a.createElement(L,{ref:this.topRef,name:"propcalc",fields:j,formData:r,twocols:"yes",calculate:this.calculate,currsymbol:a,onsave:this.saveState,showsave:f,error:s}),g),l.a.createElement("div",{className:"column results",style:{display:u?"":"none"}},K(this.state)),l.a.createElement("div",{className:"column states",style:{display:d?"":"none"}},l.a.createElement("div",{className:"my-stuff"},l.a.createElement("h6",null,"My stuff (",c,")")),l.a.createElement("div",{className:"logout"},l.a.createElement(oe,{doLogout:this.logout})),l.a.createElement("div",{className:"saved-list"},b))):l.a.createElement(re,{doLogin:this.login})}}]),t}(n.Component),me=Object(s.b)(de),pe=Object(c.withToastManager)(me);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(62);o.a.render(l.a.createElement(function(){return l.a.createElement(s.a,null,l.a.createElement(c.ToastProvider,{autoDismissTimeout:2e3,autoDismiss:!0,placement:"bottom-center"},l.a.createElement(pe,null)))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,1,2]]]);
//# sourceMappingURL=main.00238ae8.chunk.js.map