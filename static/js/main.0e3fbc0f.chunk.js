(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t){var a=String.fromCharCode(37);e.exports={types:{NUMBER:"number",TEXT:"text",CHECKBOX:"checkbox",SELECT:"select",EMAIL:"email"},currencyPlaceholder:"##CURR##",percentSign:a}},13:function(e,t){var a=[{upto:1e6,rate:1},{upto:"end",rate:2}],l=[{upto:25e4,rate:2,load:3},{upto:325e3,rate:5,load:3},{upto:75e4,rate:10,load:3},{upto:"end",rate:12,load:3}],n={commercial:{england:[{upto:15e4,rate:0},{upto:25e4,rate:2},{upto:"end",rate:5}],wales:[{upto:15e4,rate:0},{upto:25e4,rate:1},{upto:1e6,rate:5},{upto:"end",rate:6}],scotland:[{upto:15e4,rate:0},{upto:25e4,rate:1},{upto:"end",rate:5}],ireland:a},residential:{first:{england:{thresholds:[{upto:3e5,rate:0},{upto:5e5,rate:5}],limit:5e5},scotland:{thresholds:[{upto:175e3,rate:0}].concat(l),limit:-1}},england:[{upto:125e3,rate:0,load:3},{upto:25e4,rate:2,load:3},{upto:925e3,rate:5,load:3},{upto:15e5,rate:10,load:3},{upto:"end",rate:12,load:3}],wales:[{upto:18e4,rate:0,load:3},{upto:25e4,rate:3.5,load:3},{upto:4e5,rate:5,load:3},{upto:75e4,rate:7.5,load:3},{upto:15e5,rate:10,load:3},{upto:"end",rate:12,load:3}],scotland:[{upto:145e3,rate:0,load:3}].concat(l),ireland:a}};e.exports=n},16:function(e,t,a){e.exports=a(27)},25:function(e,t,a){},26:function(e,t,a){},27:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),r=a(14),o=a.n(r),i=a(11),c=a(10),s=a(9),u=a(4),d=a(6),m=a(5),p=a(3),y=a(7),h=a(2),b=a(1),f=new RegExp(b.currencyPlaceholder,"g"),g=function(e,t){var a=String.fromCharCode(t);return e.replace(f,a)};function v(e){var t=e.name,a=e.doLabelClass,l=e.dynamicLabel,r=e.label,o=e.type,i=e.currency,c=g(r,i);return n.a.createElement("div",{className:"checkbox"===o?"checkbox-label":"input-label"},n.a.createElement("label",{htmlFor:t,className:a(t)},l(t,c)))}var E={Input:function(e){var t=e.className,a=e.name,l=e.type,r=e.onInput,o=e.placeholder,i=e.label,c=e.defVal,s=e.onblur,u=e.doLabelClass,d=e.dynamicLabel,m=e.currency,p=e.required,y=e.disabled,h=g(i,m);return n.a.createElement("li",{key:a},n.a.createElement("input",{className:t||"form-control",key:a,type:l,name:a,id:a,onChange:function(e){return r(e)},autoComplete:"off",placeholder:o||h||"".concat(a," [").concat(l,"]"),value:c||"",checked:"yes"===c,onBlur:function(e){return s(e)},required:p||!1,disabled:y}),v({name:a,doLabelClass:u,dynamicLabel:d,label:i,type:l,currency:m}))},Select:function(e){var t=e.className,a=e.name,l=e.type,r=e.onInput,o=e.label,i=e.defVal,c=e.onblur,s=e.options,u=e.doLabelClass,d=e.dynamicLabel,m=e.disabled;return n.a.createElement("li",{key:a},n.a.createElement("select",{value:i,className:t||"form-control",key:a,name:a,id:a,onChange:function(e){return r(e)},onBlur:function(e){return c(e)},disabled:m},s.map(function(e){return n.a.createElement("option",{key:e.value,name:e.name,value:e.value},e.name)})),v({name:a,doLabelClass:u,dynamicLabel:d,label:o,type:l}))}},S=E.Input,C=E.Select;function F(e){var t=e.render,a=e.fields,l=e.className;return n.a.createElement("ul",{className:l},t(a))}var N=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).doLabel=a.doLabel.bind(Object(h.a)(Object(h.a)(a))),a.doLabelClass=a.doLabelClass.bind(Object(h.a)(Object(h.a)(a))),a.renderFields=a.renderFields.bind(Object(h.a)(Object(h.a)(a))),a.renderFieldCols=a.renderFieldCols.bind(Object(h.a)(Object(h.a)(a))),a.handleChange=a.handleChange.bind(Object(h.a)(Object(h.a)(a))),a.handleSave=a.handleSave.bind(Object(h.a)(Object(h.a)(a))),a}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.calculate()}},{key:"doLabel",value:function(e,t){var a=this.props.formData;return a&&a[e]?t||e:""}},{key:"doLabelClass",value:function(e){var t=this.props.formData;return t&&t[e]?"show":"hide"}},{key:"handleChange",value:function(e){var t,a=e.type,l=e.value,n=e.checked,r=e.name,o=this.props;switch(a){case b.types.NUMBER:t=Number.isNaN(l)?0:parseFloat(l)||0;break;case b.types.CHECKBOX:t=n?"yes":"no";break;default:t=l||""}o.calculate(r,t)}},{key:"handleSave",value:function(e){e.preventDefault(),(0,this.props.onsave)(),e.target.blur()}},{key:"renderFields",value:function(e){var t=this,a=[],l=this.props,n=l.currsymbol,r=l.formData;return e.forEach(function(e){var l=Object(s.a)({},e),o=l.disabled&&l.disabled.regex.test(r[l.disabled.whenField])||l.disabled2&&l.disabled2.regex.test(r[l.disabled2.whenField]);l.dynamicLabel=function(e,a){return t.doLabel(e,a)},l.doLabelClass=function(e){return t.doLabelClass(e)},l.onInput=function(e){return t.handleChange(e.target)},l.onblur=function(e){return t.handleChange(e.target)},l.currency=n,l.defVal=r[l.name],l.disabled=o,"select"===l.type?a.push(C(l)):a.push(S(l))}),a}},{key:"renderFieldCols",value:function(){var e=this.props.fields,t=Math.floor(e.length/2),a=e.slice(0),l=a.splice(t);return[n.a.createElement(F,{key:"1",fields:a,className:"left",render:this.renderFields}),n.a.createElement(F,{key:"2",fields:l,className:"right",render:this.renderFields})]}},{key:"render",value:function(){var e=this.props,t=e.name,a=e.twocols,l=e.fields,r=e.showsave?n.a.createElement("ul",{className:"left"},n.a.createElement("li",null,n.a.createElement("button",{type:"submit",className:"btn-primary form-control",onClick:this.handleSave},"save this"))):"";return n.a.createElement("form",{name:t,id:t},"yes"===a?this.renderFieldCols():this.renderFields(l),r)}}]),t}(l.Component),k=[{label:"Project name",name:"projectName",type:b.types.TEXT,defVal:"",required:!0},{label:"Post code",name:"postCode",type:b.types.TEXT,defVal:"",required:!0},{label:"Asking price(".concat(b.currencyPlaceholder,")"),name:"askingPrice",type:b.types.NUMBER,defVal:0},{label:"Purchase price(".concat(b.currencyPlaceholder,")"),name:"propertyValue",type:b.types.NUMBER,defVal:0},{label:"Done up value(".concat(b.currencyPlaceholder,")"),name:"doneUpValue",type:b.types.NUMBER,defVal:0},{label:"Cash purchase",name:"buyingCash",type:b.types.CHECKBOX,defVal:"no"},{label:"Initial LTV(".concat(b.percentSign,")"),name:"initialLoanToValue",type:b.types.NUMBER,defVal:75,disabled:{whenField:"buyingCash",regex:/yes/}},{label:"Mortgage fee(".concat(b.currencyPlaceholder,")"),name:"initMortgageFee",type:b.types.NUMBER,defVal:0,disabled:{whenField:"buyingCash",regex:/yes/}},{label:"Surveyors fee(".concat(b.currencyPlaceholder,")"),name:"initSurveyorsFee",type:b.types.NUMBER,defVal:600},{label:"Legal fees(".concat(b.currencyPlaceholder,")"),name:"initLegalFee",type:b.types.NUMBER,defVal:1500},{label:"Stamp duty type",name:"stampDutyType",type:b.types.SELECT,options:[{value:"residential",name:"Residential"},{value:"commercial",name:"Commercial"}],defVal:"residential"},{label:"Stamp duty region",name:"stampDutyRegion",type:b.types.SELECT,options:[{value:"england",name:"England/NI"},{value:"scotland",name:"Scotland"},{value:"wales",name:"Wales"},{value:"ireland",name:"Ireland"}],defVal:"england"},{label:"Stamp duty buyer",name:"stampDutyBuyer",type:b.types.SELECT,options:[{value:"investor",name:"Investor"},{value:"first",name:"First time buyer"},{value:"home",name:"Moving house"}],defVal:"investor",disabled:{whenField:"stampDutyType",regex:/commercial/}},{label:"Monthly rent(".concat(b.currencyPlaceholder,")"),name:"monthlyRent",type:b.types.NUMBER,defVal:0,disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Deal type",name:"dealType",type:b.types.SELECT,options:[{value:"btl&flip",name:"Buy to let and flip"},{value:"btl",name:"Buy to let"},{value:"flip",name:"Flip"},{value:"home",name:"Home only"}],defVal:"btl&flip"},{label:"Refurbishment cost(".concat(b.currencyPlaceholder,")"),name:"refurbCost",type:b.types.NUMBER,defVal:0},{label:"Other cost(".concat(b.currencyPlaceholder,")"),name:"otherCost",type:b.types.NUMBER,defVal:0},{label:"Remortgage fee(".concat(b.currencyPlaceholder,")"),name:"remortgageFee",type:b.types.NUMBER,defVal:0,disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Remortgage valuation fee(".concat(b.currencyPlaceholder,")"),name:"remortgageValuationFee",type:b.types.NUMBER,defVal:0,disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Remortgage legal fees(".concat(b.currencyPlaceholder,")"),name:"remortgageLegalFee",type:b.types.NUMBER,defVal:0,disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Repairing lease",name:"repairingLease",type:b.types.CHECKBOX,defVal:"no",disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Letting agents rate(".concat(b.percentSign,")"),name:"agentsPercent",type:b.types.NUMBER,defVal:10,disabled:{whenField:"repairingLease",regex:/yes/},disabled2:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"\n    MOE rate(".concat(b.percentSign,")"),name:"moePercent",type:b.types.NUMBER,defVal:15,disabled:{whenField:"repairingLease",regex:/yes/},disabled2:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Mortgage term",name:"mortgageTerm",type:b.types.NUMBER,defVal:25},{label:"Interest rate(".concat(b.percentSign,")"),name:"mortgageInterestRatePercent",type:b.types.NUMBER,defVal:6},{label:"Remortgage LTV(".concat(b.percentSign,")"),name:"loanToValue",type:b.types.NUMBER,defVal:75,disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Solicitors selling fee(".concat(b.currencyPlaceholder,")"),name:"sellingLegalFee",type:b.types.NUMBER,defVal:0,disabled:{whenField:"dealType",regex:/^((?!flip).)*$/}},{label:"Agent/selling fee(".concat(b.currencyPlaceholder,")"),name:"agentSellingFee",type:b.types.NUMBER,defVal:0,disabled:{whenField:"dealType",regex:/^((?!flip).)*$/}},{label:"Mortgage stress test(".concat(b.percentSign,")"),name:"mortgageStressMultipePercent",type:b.types.NUMBER,defVal:125,disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}},{label:"Stress interest rate(".concat(b.percentSign,")"),name:"mortgageStressInterestRatePercent",type:b.types.NUMBER,defVal:5,disabled:{whenField:"dealType",regex:/^((?!btl).)*$/}}],L=(a(25),a(15)),w=a.n(L),M=function(e,t){e.preventDefault(),e.target.blur(),t(e.target.id.split("-")[1])},O=function(e){var t,a=e.label,l=e.value,r=e.ondelete,o=e.onclick,i=e.deletable,c=e.firstname;return n.a.createElement("li",null,n.a.createElement("div",{className:"state"},n.a.createElement("button",{className:"btn-primary form-control",style:{width:"100%"},type:"submit",id:"select-".concat(l),onClick:function(e){return M(e,o)}},"".concat(a," (").concat((t=l,w()("dd/MM hh:mm:ss",new Date(parseInt(t,0))))).concat(i?"":" ".concat(c),")"))),n.a.createElement("div",{className:"remove-state"},n.a.createElement("button",{className:"btn-sm btn-primary btn-warning",type:"submit",id:"delete-".concat(l),onClick:function(e){return M(e,r)},style:{display:i?"":"none"}},"delete")))},R=function(e){var t=e.data,a=e.ondelete,l=e.onselect,r=e.onclick,o=e.useremail,i=e.filter;if(t.map){var c=t.filter(i);return n.a.createElement("ul",null,c.map(function(e,t){var i=e.projectName,c=e.id,s=e.email,u="li-".concat(c,"-").concat(t);return n.a.createElement(O,{ondelete:a,key:"li-".concat(u),label:i||"untitled",value:c,onselect:l,onclick:r,deletable:o===s,firstname:s.split("@")[0].split(".")[0]})}))}return""},T=function(e){var t=e.label,a=e.value;return n.a.createElement("li",null,n.a.createElement("div",{className:"label"},t),n.a.createElement("div",{className:"value"},a))},j=function(e){var t=e.data,a=e.id;return t?n.a.createElement("ul",null,t.map(function(e,t){var l=e.label,r=e.value,o="li-".concat(a,"-").concat(t);return n.a.createElement(T,{key:"li-".concat(o),label:l,value:r})})):""},x=/^(GIR[ ]?0AA|((AB|AL|B|BA|BB|BD|BH|BL|BN|BR|BS|BT|CA|CB|CF|CH|CM|CO|CR|CT|CV|CW|DA|DD|DE|DG|DH|DL|DN|DT|DY|E|EC|EH|EN|EX|FK|FY|G|GL|GY|GU|HA|HD|HG|HP|HR|HS|HU|HX|IG|IM|IP|IV|JE|KA|KT|KW|KY|L|LA|LD|LE|LL|LN|LS|LU|M|ME|MK|ML|N|NE|NG|NN|NP|NR|NW|OL|OX|PA|PE|PH|PL|PO|PR|RG|RH|RM|S|SA|SE|SG|SK|SL|SM|SN|SO|SP|SR|SS|ST|SW|SY|TA|TD|TF|TN|TQ|TR|TS|TW|UB|W|WA|WC|WD|WF|WN|WR|WS|WV|YO|ZE)(\d[\dA-Z]?[ ]?\d[ABD-HJLN-UW-Z]{2}))|BFPO[ ]?\d{1,4})$/,B=function(e){return x.test(e.toUpperCase())},V={rmBuy:{commercial:"https://www.rightmove.co.uk/commercial-property-for-sale/search.html?radius=0.25&includeSSTC=true&searchLocation=",residential:"https://www.rightmove.co.uk/property-for-sale/search.html?radius=0.25&includeSSTC=true&searchLocation="},rmRent:{commercial:"https://www.rightmove.co.uk/commercial-property-to-let/search.html?radius=0.25&includeLetAgreed=true&searchLocation=",residential:"https://www.rightmove.co.uk/property-to-rent/search.html?radius=0.25&includeLetAgreed=true&searchLocation="},nhpSold:"https://www.onthemarket.com/uk-house-prices/?property-type-prices=any&search-type=prices&sold-in=all-years&tenure=any&sold-prices-input=",gMap:"https://www.google.com/maps/place/"};function D(e){var t=e.href,a=e.text;return n.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:t},a)}var P=function(e){var t=e.postCode,a=e.askingPrice,l=e.monthlyRent,r=e.propertyValue,o=e.stampDutyType.startsWith("commercial")?"commercial":"residential",i=1e3,c=1e5,s=Math.ceil((a||r||4e5)/c*1.2)*c,u=Math.ceil((l||i)/i*1.2)*i;return t&&B(t)?n.a.createElement(n.a.Fragment,null,n.a.createElement(D,{href:V.nhpSold+t,text:"sold"})," | ",n.a.createElement(D,{href:"".concat(V.rmBuy[o]+t,"&maxPrice=").concat(s),text:"for sale"})," | ",n.a.createElement(D,{href:"".concat(V.rmRent[o]+t,"&maxPrice=").concat(u),text:"to let"})," | ",n.a.createElement(D,{href:V.gMap+t,text:"gmap"})):n.a.createElement("span",{style:{color:"red",fontStyle:"italic"}},"use a full valid post code to see links here")};var I=function(e){var t=e.data,a=e.currentState,l=e.currentState,r=l.postCode,o=l.dealType,i=t.dealFinance,c=t.buyToLet,s=t.stress,u=t.flip,d=/btl/.test(o),m=/flip/.test(o);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"res-block",style:{display:B(r)?"":"none"}},n.a.createElement("h6",null,"Links for this post code"),P(a)),n.a.createElement("div",{className:"res-block"},n.a.createElement("h6",null,"Deal finance"),n.a.createElement(j,{id:"1",data:i})),n.a.createElement("div",{className:"res-block",style:{display:d?"":"none"}},n.a.createElement("h6",null,"Buy to let"),n.a.createElement(j,{id:"2",data:c||""})),n.a.createElement("div",{className:"res-block",style:{display:d?"":"none"}},n.a.createElement("h6",null,"Stress test"),n.a.createElement(j,{id:"3",data:s||""})),n.a.createElement("div",{className:"res-block",style:{display:m?"":"none"}},n.a.createElement("h6",null,"Flip"),n.a.createElement(j,{id:"4",data:u})))},U=a(13),A=a.n(U),W=function(e,t,a,l){var n=e/100,r=A.a[t][a];if("first"===l&&"residential"===t&&!/^ireland$|^wales$/.test(a)){var o=A.a[t].first[a],i=o.limit,c=o.thresholds;(-1===i||e<=i)&&(r=c)}var s,u,d,m=0;if(!t||!a)return 0;for(var p=0;p<r.length;p+=1){d="investor"===l&&r[p].load||0,s=r[p].upto;var y=r[p].rate;if(u=p>0?r[p-1].upto:0,"end"===s)return m+=(n-u/100)*(y+d);if(e<=s)return m+=0===p?n*(y+d):(n-u/100)*(y+d);m+=(s-u)/100*(y+d)}return m},H=function(e,t,a,l,n,r,o,i,c){return e+t+a+l+n+W(r,o,i,c)+r},$=["Remortgage advance","Remortgage deposit","Remortgage fees","Money in","Money out","Money left in","Monthly rental","Monthly mortgage payment","MOE","Letting agent fees","Monthly free cashflow","Gross yield"],G=["Mortgage advance","Deposit","Stamp duty","Professional fees","Refurb/other costs","Total money in","Total cost","Interest only mortgage (monthly)","Repayment mortgage (monthly)"],K=["Sale price","Selling costs","Total input costs","Profit (before tax)","Gain(%)"],X=["Stress test","Minimum rent"],q=String.fromCharCode(37),J={freeCash:function(e){var t=e.loanToValue,a=e.propertyValue,l=e.doneUpValue,n=e.mortgageInterestRatePercent,r=e.monthlyRent,o=e.moePercent,i=e.agentsPercent,c=e.refurbCost,s=e.otherCost,u=e.stampDutyType,d=e.stampDutyRegion,m=e.stampDutyBuyer,p=e.remortgageFee,y=e.remortgageValuationFee,h=e.remortgageLegalFee,b=e.initMortgageFee,f=e.initLegalFee,g=e.initSurveyorsFee,v=e.repairingLease,E="yes"===v,S=t/100,C=Math.round(l*S),F=Math.round(l*(1-S)),N=Math.round(C*n/1200),k=E?0:r*o/100,L=E?0:r*i/100,w=r-("yes"===v?0:k)-N-L,M=p+y+h,O=b+f+g+(c+s)+W(a,u,d,m)+a,R=1200*r/O,T=$;return[{label:T[0],value:C.toFixed(2)},{label:T[1],value:F.toFixed(2)},{label:T[2],value:M.toFixed(2)},{label:T[3],value:O.toFixed(2)},{label:T[4],value:(C-M).toFixed(2)},{label:T[5],value:(O-(C-M)).toFixed(2)},{label:T[6],value:r.toFixed(2)},{label:T[7],value:N.toFixed(2)},{label:T[8],value:k.toFixed(2)},{label:T[9],value:L.toFixed(2)},{label:T[10],value:w.toFixed(2)},{label:T[11],value:R.toFixed(2)+q}]},initialFinance:function(e){var t,a,l=e.buyingCash,n=e.initialLoanToValue,r=e.mortgageInterestRatePercent,o=e.propertyValue,i=e.initSurveyorsFee,c=e.initLegalFee,s=e.initMortgageFee,u=e.refurbCost,d=e.otherCost,m=e.stampDutyType,p=e.stampDutyRegion,y=e.stampDutyBuyer,h=e.mortgageTerm,b="yes"===l,f=n/100,g=b?0:Math.round(o*f),v=Math.round(g*r/1200),E=(a=h,(t=r)/100/12*g/(1-Math.pow(1+t/100/12,12*-a))),S=i+c+s,C=u+d,F=b?o:Math.round(o*(1-f)),N=W(o,m,p,y),k=H(i,c,s,u,d,o,m,p,y),L=k-g,w=G;return[{label:w[0],value:g.toFixed(2)},{label:w[1],value:F.toFixed(2)},{label:w[2],value:N.toFixed(2)},{label:w[3],value:S.toFixed(2)},{label:w[4],value:C.toFixed(2)},{label:w[5],value:L.toFixed(2)},{label:w[6],value:k.toFixed(2)},{label:w[7],value:v.toFixed(2)},{label:w[8],value:E.toFixed(2)}]},flip:function(e){var t=e.sellingLegalFee,a=e.agentSellingFee,l=e.initSurveyorsFee,n=e.initLegalFee,r=e.initMortgageFee,o=e.refurbCost,i=e.otherCost,c=e.propertyValue,s=e.stampDutyType,u=e.stampDutyRegion,d=e.stampDutyBuyer,m=e.doneUpValue,p=H(l,n,r,o,i,c,s,u,d),y=t+a,h=Math.round((m-p)/p*1e4)/100,b=h>=20?"green":"red",f=K;return[{label:f[0],value:m.toFixed(2)},{label:f[1],value:y.toFixed(2)},{label:f[2],value:p.toFixed(2)||"0"},{label:f[3],value:(m-(p+y)).toFixed(2)||"0",col:b},{label:f[4],value:h.toFixed(2)||0,col:b}]},allInputCosts:H,stressTest:function(e){var t=e.doneUpValue,a=e.monthlyRent,l=e.loanToValue,n=e.mortgageStressInterestRatePercent,r=e.mortgageStressMultipePercent,o=Math.ceil(t*l/100*n/1200*r/100),i=a>=o,c=X;return[{label:c[0],value:i?"pass":"fail"},{label:c[1],value:o.toFixed(2)}]},getCurrencyCode:function(e){return"ireland"===e.stampDutyRegion?8364:163}},Y={label:"User",name:"userEmail",type:b.types.EMAIL,defVal:"",required:!0},Z=Y.name,z=Y.type,Q=Y.label,_=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={email:""},a.handleChange=a.handleChange.bind(Object(h.a)(Object(h.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(Object(h.a)(a))),a}return Object(y.a)(t,e),Object(p.a)(t,[{key:"handleChange",value:function(e){this.setState({email:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this.props.doLogin,a=this.state.email;e.preventDefault(),a&&t(a)}},{key:"render",value:function(){return n.a.createElement("div",{className:"column",style:{textAlign:"center"}},n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement("input",{className:"form-control",key:Z,type:z,name:Z,id:Z,autoComplete:"off",placeholder:"".concat(Q," [").concat(z,"]"),onChange:this.handleChange,onBlur:this.handleChange,required:!0}),n.a.createElement("button",{type:"submit",className:"btn-primary form-control"},"go")))}}]),t}(l.Component);var ee=function(e){var t=e.doLogout;return n.a.createElement("button",{type:"submit",className:"",onClick:function(e){e.preventDefault(),t()}},"logoff")},te="https://ww69n8b5kk.execute-api.eu-west-2.amazonaws.com/dev/comparisons",ae=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={data:{dealFinance:[],buyToLet:[],stress:[],flip:[]},currency:163,savedStates:{Items:[]},currentState:{projectName:""},hasWorkingAPI:!1,userEmail:e.cookies.get("email")||""},a.calculate=a.calculate.bind(Object(h.a)(Object(h.a)(a))),a.saveState=a.saveState.bind(Object(h.a)(Object(h.a)(a))),a.deleteState=a.deleteState.bind(Object(h.a)(Object(h.a)(a))),a.selectState=a.selectState.bind(Object(h.a)(Object(h.a)(a))),a.login=a.login.bind(Object(h.a)(Object(h.a)(a))),a.logout=a.logout.bind(Object(h.a)(Object(h.a)(a))),a}return Object(y.a)(t,e),Object(p.a)(t,null,[{key:"setDefaultFormData",value:function(){var e={};return k.map(function(t){return e[t.name]=t.defVal,!1}),e}}]),Object(p.a)(t,[{key:"componentDidMount",value:function(){""!==this.state.userEmail&&this.getSavedStates(!0)}},{key:"getSavedStates",value:function(e){var t=this,a=function(e,t){var a=e.projectName,l=e.id,n=t.projectName,r=t.id;return a+l<n+r?-1:a+l>n+r?1:0},l=this.state.userEmail;fetch("".concat(te,"/user/").concat(l)).then(function(e){return e.json()}).then(function(l){l.Items.length>0&&l.Items.sort(a),t.loadState(l,e)}).catch(function(){t.loadState(null,!0)})}},{key:"findState",value:function(e){return this.state.savedStates.Items.find(function(t){return t.id===e})}},{key:"loadState",value:function(e,a){var l=this.state.userEmail,n={savedStates:e||{Items:[]},hasWorkingAPI:!!e};a&&(n.currentState=t.setDefaultFormData()),l&&n.currentState&&(n.currentState.email=l),this.setState(n)}},{key:"calculate",value:function(e,t){var a=this.state.currentState,l=e?Object(s.a)({},a,Object(c.a)({},e,t)):a,n=J.initialFinance(l),r=J.freeCash(l),o=J.flip(l),i=J.stressTest(l),u=J.getCurrencyCode(l);document.getElementById("doc-title").text=l.projectName.replace(/ /g,"-");var d={data:{dealFinance:n,buyToLet:r,stress:i,flip:o},currency:u};e&&(d.currentState=l),this.setState(d)}},{key:"saveState",value:function(){var e=this,t=this.state,a=t.currentState,l=t.currentState,n=l.projectName,r=l.postCode,o=t.userEmail;if(""!==n&&""!==r){var i=Object(s.a)({},a,{email:o});fetch(te,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then(function(e){return e.json()}).then(function(){e.getSavedStates(!1)}).catch(function(){return e.setState({savedStates:{Items:"No save service available"}})}).finally(function(){e.setState({error:null})})}}},{key:"deleteState",value:function(e){var t=this,a=this.state.userEmail;fetch(te,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,email:a})}).then(function(a){if(!a.ok)throw new Error("delete failed");var l=t.state.currentState;t.getSavedStates(e===l)}).catch(function(){return t.setState({savedStates:{Items:"No delete service avaialable"}})})}},{key:"selectState",value:function(e){var t=this,a=this.findState(e);this.setState({currentState:a},function(){return t.calculate()})}},{key:"handleNew",value:function(e){var a=this;e.preventDefault(),this.setState({currentState:t.setDefaultFormData()},function(){return a.calculate()}),e.target.blur()}},{key:"login",value:function(e){var t=this;this.props.cookies.set("email",e,{path:"/"}),this.setState({userEmail:e},function(){t.getSavedStates(!0)})}},{key:"logout",value:function(){this.props.cookies.set("email","",{path:"/"}),this.setState({userEmail:""})}},{key:"render",value:function(){var e=this,t=this.state,a=t.currency,l=t.savedStates,r=t.currentState,o=t.hasWorkingAPI,i=t.error,c=t.userEmail,s=r.projectName,u=r.postCode,d=o&&""!==s&&""!==u,m=l.Items,p=m.length>0&&c?n.a.createElement(n.a.Fragment,null,n.a.createElement(R,{data:m,ondelete:this.deleteState,onclick:this.selectState,useremail:c,filter:function(e){return e.email===c},doLogin:this.login}),n.a.createElement("h6",null,"Other saved stuff"),n.a.createElement(R,{data:m,ondelete:this.deleteState,onclick:this.selectState,useremail:c,filter:function(e){return e.email!==c}})):"",y=""!==r.projectName?n.a.createElement("ul",{className:"right"},n.a.createElement("li",null,n.a.createElement("button",{type:"submit",className:"btn-primary form-control",onClick:function(t){return e.handleNew(t)}},"new"))):"";return Object.keys(r).length>1&&c?n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"column",style:{textAlign:"center"}},n.a.createElement("h5",null,"Property investment deal analyser"),n.a.createElement(N,{name:"propcalc",fields:k,formData:r,twocols:"yes",calculate:this.calculate,currsymbol:a,onsave:this.saveState,showsave:d,error:i}),y),n.a.createElement("div",{className:"column results"},I(this.state)),n.a.createElement("div",{className:"column states"},n.a.createElement("div",{style:{float:"left"}},n.a.createElement("h6",null,"My stuff (",c,")")),n.a.createElement("div",{style:{float:"left"}},n.a.createElement(ee,{doLogout:this.logout})),p)):n.a.createElement(_,{doLogin:this.login})}}]),t}(l.Component),le=Object(i.b)(ae);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(26);o.a.render(n.a.createElement(function(){return n.a.createElement(i.a,null,n.a.createElement(le,null))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[16,1,2]]]);
//# sourceMappingURL=main.0e3fbc0f.chunk.js.map