(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(e,a){var t=String.fromCharCode(37),n=[{label:"Project name",name:"projectName",type:"text"},{label:"Purchase price(".concat("##CURR##",")"),name:"propertyValue",type:"number",defVal:0},{label:"Done up value(".concat("##CURR##",")"),name:"doneUpValue",type:"number",defVal:0},{label:"Monthly rent(".concat("##CURR##",")"),name:"monthlyRent",type:"number",defVal:0},{label:"Initial LTV(".concat(t,")"),name:"initialLoanToValue",type:"number",defVal:75},{label:"Cash purchase",name:"buyingCash",type:"checkbox",defVal:"no"},{label:"Surveyors fee(".concat("##CURR##",")"),name:"initSurveyorsFee",type:"number",defVal:600},{label:"Mortgage fee(".concat("##CURR##",")"),name:"initMortgageFee",type:"number",defVal:0},{label:"Legal fees(".concat("##CURR##",")"),name:"initLegalFee",type:"number",defVal:1500},{label:"Stamp duty",name:"stampDutyType",type:"select",options:[{value:"residential",name:"Residential Eng/NI"},{value:"commercial",name:"Commercial Eng/NI"},{value:"residentialWales",name:"Residential Wales"},{value:"commercialWales",name:"Commercial Wales"},{value:"residentialScotland",name:"Residential Scotland"},{value:"commercialScotland",name:"Commercial Scotland"},{value:"ireland",name:"Ireland"}],defVal:"residential"},{label:"Refurbishment cost(".concat("##CURR##",")"),name:"refurbCost",type:"number",defVal:0},{label:"Other cost(".concat("##CURR##",")"),name:"otherCost",type:"number",defVal:0},{label:"Remortgage fee(".concat("##CURR##",")"),name:"remortgageFee",type:"number",defVal:0},{label:"Remortgage valuation fee(".concat("##CURR##",")"),name:"remortgageValuationFee",type:"number",defVal:0},{label:"Remortgage legal fees(".concat("##CURR##",")"),name:"remortgageLegalFee",type:"number",defVal:0},{label:"Letting agents rate(".concat(t,")"),name:"agentsPercent",type:"number",defVal:10},{label:"\n    MOE rate(".concat(t,")"),name:"moePercent",type:"number",defVal:15},{label:"Repairing lease",name:"repairingLease",type:"checkbox",defVal:"no"},{label:"Interest rate(".concat(t,")"),name:"mortgageInterestRatePercent",type:"number",defVal:6},{label:"Remortgage LTV(".concat(t,")"),name:"loanToValue",type:"number",defVal:75},{label:"Solicitors selling fee(".concat("##CURR##",")"),name:"sellingLegalFee",type:"number",defVal:0},{label:"Agent/selling fee(".concat("##CURR##",")"),name:"agentSellingFee",type:"number",defVal:0},{label:"Mortgage stress test(".concat(t,")"),name:"mortgageStressMultipePercent",type:"number",defVal:125},{label:"Stress interest rate(".concat(t,")"),name:"mortgageStressInterestRatePercent",type:"number",defVal:5}];e.exports={fields:n,currencyPlaceholder:"##CURR##"}},,,,,,,function(e,a){e.exports={commercial:[{upto:15e4,rate:0},{upto:25e4,rate:2},{upto:"end",rate:5}],residential:[{upto:125e3,rate:0,load:3},{upto:25e4,rate:2,load:3},{upto:925e3,rate:5,load:3},{upto:15e5,rate:10,load:3},{upto:"end",rate:12,load:3}],ireland:[{upto:1e6,rate:1},{upto:"end",rate:2}],residentialWales:[{upto:18e4,rate:0,load:3},{upto:25e4,rate:3.5,load:3},{upto:4e5,rate:5,load:3},{upto:75e4,rate:7.5,load:3},{upto:15e5,rate:10,load:3},{upto:"end",rate:12,load:3}],commercialWales:[{upto:15e4,rate:0},{upto:25e4,rate:1},{upto:1e6,rate:5},{upto:"end",rate:6}],residentialScotland:[{upto:145e3,rate:0,load:3},{upto:25e4,rate:2,load:3},{upto:325e3,rate:5,load:3},{upto:75e4,rate:10,load:3},{upto:"end",rate:12,load:3}],commercialScotland:[{upto:15e4,rate:0},{upto:25e4,rate:1},{upto:"end",rate:5}]}},function(e,a,t){e.exports=t(21)},,,,,,function(e,a,t){},function(e,a,t){},function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(11),o=t.n(r),c=t(2),i=t(3),s=t(6),u=t(9),d=t(7),m=t(4),b=t(8),p=t(1),f=t(5),v=new RegExp(f.currencyPlaceholder,"g"),y=function(e,a){var t=String.fromCharCode(a);return e.replace(v,t)};function h(e){var a=e.name,t=e.doLabelClass,n=e.dynamicLabel,r=e.label,o=e.type,c=e.currency,i=y(r,c);return l.a.createElement("div",{className:"checkbox"===o?"checkbox-label":"input-label"},l.a.createElement("label",{htmlFor:a,className:t(a)},n(a,i)))}var g={Input:function(e){var a=e.className,t=e.name,n=e.type,r=e.onInput,o=e.placeholder,c=e.label,i=e.defVal,s=e.onblur,u=e.doLabelClass,d=e.dynamicLabel,m=e.currency,b=y(c,m);return l.a.createElement("li",{key:t},l.a.createElement("input",{className:a||"form-control",key:t,type:n,name:t,id:t,onChange:function(e){return r(e)},autoComplete:"off",placeholder:o||b||"".concat(t," [").concat(n,"]"),defaultValue:i||"",defaultChecked:"yes"===i,onBlur:function(e){return s(e)}}),h({name:t,doLabelClass:u,dynamicLabel:d,label:c,type:n,currency:m}))},Select:function(e){var a=e.className,t=e.name,n=e.type,r=e.onInput,o=e.label,c=e.defVal,i=e.onblur,s=e.options,u=e.doLabelClass,d=e.dynamicLabel;return l.a.createElement("li",{key:t},l.a.createElement("select",{value:c,className:a||"form-control",key:t,name:t,id:t,onChange:function(e){return r(e)},onBlur:function(e){return i(e)}},s.map(function(e){return l.a.createElement("option",{key:e.value,name:e.name,value:e.value},e.name)})),h({name:t,doLabelClass:u,dynamicLabel:d,label:o,type:n}))}},F=g.Input,C=g.Select;function S(e){var a=e.render,t=e.fields,n=e.className;return l.a.createElement("ul",{className:n},a(t))}var E=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).state={fields:e.fields,formData:e.formData},t.doLabel=t.doLabel.bind(Object(p.a)(Object(p.a)(t))),t.doLabelClass=t.doLabelClass.bind(Object(p.a)(Object(p.a)(t))),t.renderFields=t.renderFields.bind(Object(p.a)(Object(p.a)(t))),t.renderFieldCols=t.renderFieldCols.bind(Object(p.a)(Object(p.a)(t))),t.handleChange=t.handleChange.bind(Object(p.a)(Object(p.a)(t))),t.handleSave=t.handleSave.bind(Object(p.a)(Object(p.a)(t))),t}return Object(b.a)(a,e),Object(m.a)(a,[{key:"componentDidMount",value:function(){this.props.calculate("projectName","")}},{key:"doLabel",value:function(e,a){var t=this.state.formData;return t&&t[e]?a||e:""}},{key:"doLabelClass",value:function(e){var a=this.state.formData;return a&&a[e]?"show":"hide"}},{key:"handleChange",value:function(e){var a,t=e.type,n=e.value,l=e.checked,r=e.name,o=this.props,s=this.state.formData;switch(t){case"number":a=Number.isNaN(n)?0:parseFloat(n)||0;break;case"checkbox":a=l?"yes":"no";break;default:a=n||""}o.calculate(r,a),this.setState({formData:Object(i.a)({},s,Object(c.a)({},r,a))})}},{key:"handleSave",value:function(e){e.preventDefault();var a=this.state;(0,this.props.onsave)(a.formData),e.target.blur()}},{key:"renderFields",value:function(e){var a=this,t=[],n=this.props,l=n.currsymbol,r=n.formData;return e.forEach(function(e){var n=Object(i.a)({},e);n.dynamicLabel=function(e,t){return a.doLabel(e,t)},n.doLabelClass=function(e){return a.doLabelClass(e)},n.onInput=function(e){return a.handleChange(e.target)},n.onblur=function(e){return a.handleChange(e.target)},n.currency=l,n.defVal=r[n.name],"select"===n.type?t.push(C(n)):t.push(F(n))}),t}},{key:"renderFieldCols",value:function(){var e=this.state,a=Math.floor(e.fields.length/2),t=e.fields.slice(0),n=t.splice(a);return[l.a.createElement(S,{key:"1",fields:t,className:"left",render:this.renderFields}),l.a.createElement(S,{key:"2",fields:n,className:"right",render:this.renderFields})]}},{key:"render",value:function(){var e=this.props,a=e.name,t=e.twocols,n=e.fields,r=e.showsave?l.a.createElement("button",{type:"submit",className:"btn-primary form-control",onClick:this.handleSave},"save this"):"";return l.a.createElement("form",{name:a,id:a},"yes"===t?this.renderFieldCols():this.renderFields(n),r)}}]),a}(n.Component),R=(t(19),function(e){var a=e.label,t=e.value;return l.a.createElement("li",null,l.a.createElement("div",{className:"label"},a),l.a.createElement("div",{className:"value"},t))}),j=function(e){var a=e.data,t=e.id;return l.a.createElement("ul",null,a.map(function(e,a){var n=e.label,r=e.value,o="li-".concat(t,"-").concat(a);return l.a.createElement(R,{key:"li-".concat(o),label:n,value:r})}))},k=function(e){var a=e.label,t=e.value,n=e.ondelete;return l.a.createElement("li",null,l.a.createElement("div",{className:"state"},l.a.createElement("a",{className:"btn-sm btn-primary",style:{width:"100%"},href:t,type:"submit",id:"select-".concat(t)},a)),l.a.createElement("div",{className:"remove-state"},l.a.createElement("button",{className:"btn-sm btn-primary btn-warning",type:"submit",id:"delete-".concat(t),onClick:function(e){return function(e,a){e.preventDefault(),a(e.target.id.split("-")[1])}(e,n)}},"delete")))},V=function(e){var a=e.data,t=e.ondelete,n=e.onselect;return a.map?l.a.createElement("ul",null,a.map(function(e,a){var r=e.projectName,o=e.id,c="li-".concat(o,"-").concat(a);return l.a.createElement(k,{ondelete:t,key:"li-".concat(c),label:r||"untitled",value:o,onselect:n})})):""},O=t(12),L=t.n(O),N=function(e,a){var t,n,l,r=e/100,o=L.a[a],c=0;if(!a)return 0;for(var i=0;i<o.length;i+=1){l=o[i].load||0,t=o[i].upto;var s=o[i].rate;if(n=i>0?o[i-1].upto:0,"end"===t)return c+=(r-n/100)*(s+l);if(e<=t)return c+=0===i?r*(s+l):(r-n/100)*(s+l);c+=(t-n)/100*(s+l)}return c},x=["Remortgage advance","Remortgage deposit","Remortgage fees","Money in","Money out","Money left in","Monthly rental","Monthly mortgage payment","MOE","Letting agent fees","Monthly free cashflow"],D=["Mortgage advance","Deposit","Stamp duty","Professional fees","Refurb/other costs","Total money in","Total cost"],M=["Sale price","Selling costs","Total input costs","Profit (before tax)","Gain(%)"],I=["Stress test","Minimum rent"],w=function(e,a,t,n,l,r,o){return e+a+t+n+l+N(r,o)+r},T={freeCash:function(e){var a=e.loanToValue,t=e.propertyValue,n=e.doneUpValue,l=e.mortgageInterestRatePercent,r=e.monthlyRent,o=e.moePercent,c=e.agentsPercent,i=e.refurbCost,s=e.otherCost,u=e.stampDutyType,d=e.remortgageFee,m=e.remortgageValuationFee,b=e.remortgageLegalFee,p=e.initMortgageFee,f=e.initLegalFee,v=e.initSurveyorsFee,y=e.repairingLease,h=a/100,g=Math.round(n*h),F=Math.round(n*(1-h)),C=Math.round(g*l/1200),S="yes"===y?0:r*o/100,E=r*c/100,R=r-("yes"===y?0:S)-C-E,j=d+m+b,k=p+f+v+(i+s)+N(t,u)+t,V=x;return[{label:V[0],value:g.toFixed(2)},{label:V[1],value:F.toFixed(2)},{label:V[2],value:j.toFixed(2)},{label:V[3],value:k.toFixed(2)},{label:V[4],value:(g-j).toFixed(2)},{label:V[5],value:(k-(g-j)).toFixed(2)},{label:V[6],value:r.toFixed(2)},{label:V[7],value:C.toFixed(2)},{label:V[8],value:S.toFixed(2)},{label:V[9],value:E.toFixed(2)},{label:V[10],value:R.toFixed(2)}]},initialFinance:function(e){var a=e.buyingCash,t=e.initialLoanToValue,n=e.propertyValue,l=e.initSurveyorsFee,r=e.initLegalFee,o=e.initMortgageFee,c=e.refurbCost,i=e.otherCost,s=e.stampDutyType,u="yes"===a,d=t/100,m=u?0:Math.round(n*d),b=l+r+o,p=c+i,f=u?n:Math.round(n*(1-d)),v=N(n,s),y=w(l,r,o,c,i,n,s),h=y-m,g=D;return[{label:g[0],value:m.toFixed(2)},{label:g[1],value:f.toFixed(2)},{label:g[2],value:v.toFixed(2)},{label:g[3],value:b.toFixed(2)},{label:g[4],value:p.toFixed(2)},{label:g[5],value:h.toFixed(2)},{label:g[6],value:y.toFixed(2)}]},flip:function(e){var a=e.sellingLegalFee,t=e.agentSellingFee,n=e.initSurveyorsFee,l=e.initLegalFee,r=e.initMortgageFee,o=e.refurbCost,c=e.otherCost,i=e.propertyValue,s=e.stampDutyType,u=e.doneUpValue,d=w(n,l,r,o,c,i,s),m=a+t,b=Math.round((u-d)/d*1e4)/100,p=b>=20?"green":"red",f=M;return[{label:f[0],value:u.toFixed(2)},{label:f[1],value:m.toFixed(2)},{label:f[2],value:d.toFixed(2)||"0"},{label:f[3],value:(u-(d+m)).toFixed(2)||"0",col:p},{label:f[4],value:b.toFixed(2)||0,col:p}]},allInputCosts:w,stressTest:function(e){var a=e.doneUpValue,t=e.monthlyRent,n=e.loanToValue,l=e.mortgageStressInterestRatePercent,r=e.mortgageStressMultipePercent,o=Math.ceil(a*n/100*l/1200*r/100),c=t>=o,i=I;return[{label:i[0],value:c?"pass":"fail"},{label:i[1],value:o.toFixed(2)}]},getCurrencyCode:function(e){return"ireland"===e.stampDutyType?8364:163}},P=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).state={data:{dealFinance:[],buyToLet:[],stress:[],flip:[]},fields:f.fields,currency:163,savedStates:{Items:[]},currentState:null,hasWorkingAPI:!1},t.doResults=t.doResults.bind(Object(p.a)(Object(p.a)(t))),t.calculate=t.calculate.bind(Object(p.a)(Object(p.a)(t))),t.setDefaultFormData=t.setDefaultFormData.bind(Object(p.a)(Object(p.a)(t))),t.saveState=t.saveState.bind(Object(p.a)(Object(p.a)(t))),t.deleteState=t.deleteState.bind(Object(p.a)(Object(p.a)(t))),t}return Object(b.a)(a,e),Object(m.a)(a,null,[{key:"findState",value:function(e,a){return e.Items.find(function(e){return e.id===a})}}]),Object(m.a)(a,[{key:"componentDidMount",value:function(){this.getSavedStates()}},{key:"getSavedStates",value:function(){var e=this,a=function(){e.setState({savedStates:{Items:[]},currentState:e.setDefaultFormData(),hasWorkingAPI:!1})};a()}},{key:"setDefaultFormData",value:function(){var e={};return this.state.fields.map(function(a){return e[a.name]=a.defVal,!1}),e}},{key:"calculate",value:function(e,a){var t=this.state.currentState,n=Object(i.a)({},t,Object(c.a)({},e,a)),l=T.initialFinance(n),r=T.freeCash(n),o=T.flip(n),s=T.stressTest(n),u=T.getCurrencyCode(n);"projectName"===e&&(document.getElementById("doc-title").text=a.replace(/ /g,"-")),this.setState({data:{dealFinance:l,buyToLet:r,stress:s,flip:o},currency:u,currentState:n})}},{key:"doResults",value:function(){var e=this.state.data,a=e.dealFinance,t=e.buyToLet,n=e.stress,r=e.flip;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Deal finance"),l.a.createElement(j,{id:"1",data:a})),l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Buy to let"),l.a.createElement(j,{id:"2",data:t})),l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Stress test"),l.a.createElement(j,{id:"3",data:n})),l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Flip"),l.a.createElement(j,{id:"4",data:r})))}},{key:"saveState",value:function(){var e=this,a=this.state.currentState;""!==a.projectName?fetch("",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then(function(e){return e.json()}).then(function(){e.getSavedStates()}).catch(function(){return e.setState({savedStates:{Items:"No save service avaialable"}})}):alert("you must supply a project name")}},{key:"deleteState",value:function(e){var a=this;fetch("",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(e){if(!e.ok)throw new Error("delete failed");a.getSavedStates()}).catch(function(){return a.setState({savedStates:{Items:"No delete service avaialable"}})})}},{key:"render",value:function(){var e=this.state,a=e.currency,t=e.savedStates,n=e.currentState,r=e.hasWorkingAPI,o=t.Items,c=l.a.createElement(V,{data:o,ondelete:this.deleteState}),i=o?c:"";return n?l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"column"},l.a.createElement(E,{name:"propcalc",fields:f.fields,formData:n,twocols:"yes",calculate:this.calculate,currsymbol:a,onsave:this.saveState,showsave:r})),l.a.createElement("div",{className:"column results"},this.doResults()),l.a.createElement("div",{className:"column states"},i)):""}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(20);o.a.render(l.a.createElement(P,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[13,1,2]]]);
//# sourceMappingURL=main.8d7c8863.chunk.js.map