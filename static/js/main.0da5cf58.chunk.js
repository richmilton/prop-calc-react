(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,a){e.exports={commercial:[{upto:15e4,rate:0},{upto:25e4,rate:2},{upto:"end",rate:5}],residential:[{upto:125e3,rate:0,load:3},{upto:25e4,rate:2,load:3},{upto:925e3,rate:5,load:3},{upto:15e5,rate:10,load:3},{upto:"end",rate:12,load:3}],ireland:[{upto:1e6,rate:1},{upto:"end",rate:2}],residentialWales:[{upto:18e4,rate:0,load:3},{upto:25e4,rate:3.5,load:3},{upto:4e5,rate:5,load:3},{upto:75e4,rate:7.5,load:3},{upto:15e5,rate:10,load:3},{upto:"end",rate:12,load:3}],commercialWales:[{upto:15e4,rate:0},{upto:25e4,rate:1},{upto:1e6,rate:5},{upto:"end",rate:6}],residentialScotland:[{upto:145e3,rate:0,load:3},{upto:25e4,rate:2,load:3},{upto:325e3,rate:5,load:3},{upto:75e4,rate:10,load:3},{upto:"end",rate:12,load:3}],commercialScotland:[{upto:15e4,rate:0},{upto:25e4,rate:1},{upto:"end",rate:5}]}},19:function(e,a,t){e.exports=t(30)},25:function(e,a,t){},29:function(e,a,t){},30:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(14),o=t.n(r),c=t(33),i=t(32),s=t(8),u=t(11),d=t(9),m=t(3),f=t(7),p=t(12),b=t(17),v=t(6),y=new RegExp(v.currencyPlaceholder,"g"),h=function(e,a){var t=String.fromCharCode(a);return e.replace(y,t)};function g(e){var a=e.name,t=e.doLabelClass,n=e.dynamicLabel,r=e.label,o=e.type,c=e.currency,i=h(r,c);return l.a.createElement("div",{className:"checkbox"===o?"checkbox-label":"input-label"},l.a.createElement("label",{htmlFor:a,className:t(a)},n(a,i)))}var S={Input:function(e){var a=e.className,t=e.name,n=e.type,r=e.onInput,o=e.placeholder,c=e.label,i=e.defVal,s=e.onblur,u=e.doLabelClass,d=e.dynamicLabel,m=e.currency,f=h(c,m);return l.a.createElement("li",{key:t},l.a.createElement("input",{className:a||"form-control",key:t,type:n,name:t,id:t,onChange:function(e){return r(e)},autoComplete:"off",placeholder:o||f||"".concat(t," [").concat(n,"]"),defaultValue:i||"",defaultChecked:"yes"===i,onBlur:function(e){return s(e)}}),g({name:t,doLabelClass:u,dynamicLabel:d,label:c,type:n,currency:m}))},Select:function(e){var a=e.className,t=e.name,n=e.type,r=e.onInput,o=e.label,c=e.defVal,i=e.onblur,s=e.options,u=e.doLabelClass,d=e.dynamicLabel;return l.a.createElement("li",{key:t},l.a.createElement("select",{value:c,className:a||"form-control",key:t,name:t,id:t,onChange:function(e){return r(e)},onBlur:function(e){return i(e)}},s.map(function(e){return l.a.createElement("option",{key:e.value,name:e.name,value:e.value},e.name)})),g({name:t,doLabelClass:u,dynamicLabel:d,label:o,type:n}))}},F=S.Input,C=S.Select;function E(e){var a=e.render,t=e.fields,n=e.className;return l.a.createElement("ul",{className:n},a(t))}var R=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).state={formData:e.formData},t.doLabel=t.doLabel.bind(Object(m.a)(t)),t.doLabelClass=t.doLabelClass.bind(Object(m.a)(t)),t.renderFields=t.renderFields.bind(Object(m.a)(t)),t.renderFieldCols=t.renderFieldCols.bind(Object(m.a)(t)),t.handleChange=t.handleChange.bind(Object(m.a)(t)),t.handleSave=t.handleSave.bind(Object(m.a)(t)),t}return Object(p.a)(a,e),Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,a=this.state;e.calculate(a.formData)}},{key:"componentDidUpdate",value:function(){var e=this.state.formData.projName;document.getElementById("doc-title").text=e?e.replace(/ /g,"-"):"Untitled"}},{key:"doLabel",value:function(e,a){var t=this.state.formData;return t&&t[e]?a||e:""}},{key:"doLabelClass",value:function(e){var a=this.state.formData;return a&&a[e]?"show":"hide"}},{key:"handleChange",value:function(e){var a,t=e.type,n=e.value,l=e.checked,r=e.name,o=this.state,c=this.props,i=o.formData;switch(t){case"number":a=Number.isNaN(n)?0:parseFloat(n)||0;break;case"checkbox":a=l?"yes":"no";break;default:a=n||""}i[r]=a,this.setState({formData:i},function(){/^select-one$|^checkbox$|^number$/.test(t)&&c.calculate(o.formData)})}},{key:"handleSave",value:function(e){e.preventDefault();var a=this.state;(0,this.props.onsave)(a.formData),e.target.blur()}},{key:"renderFields",value:function(e){var a=this,t=[],n=this.props;return n.formData&&e.forEach(function(e){var l=Object(b.a)({},e);l.dynamicLabel=function(e,t){return a.doLabel(e,t)},l.doLabelClass=function(e){return a.doLabelClass(e)},l.onInput=function(e){return a.handleChange(e.target)},l.onblur=function(e){return a.handleChange(e.target)},l.currency=n.currsymbol,l.defVal=n.formData[l.name],"select"===l.type?t.push(C(l)):t.push(F(l))}),t}},{key:"renderFieldCols",value:function(){var e=this.props,a=Math.floor(e.fields.length/2),t=e.fields.slice(0),n=t.splice(a);return[l.a.createElement(E,{key:"1",fields:t,className:"left",render:this.renderFields}),l.a.createElement(E,{key:"2",fields:n,className:"right",render:this.renderFields})]}},{key:"render",value:function(){var e=this.props;return l.a.createElement("form",{name:e.name,id:e.name},"yes"===e.twocols?this.renderFieldCols():this.renderFields(e.fields),l.a.createElement("button",{type:"submit",className:"btn-primary form-control",onClick:this.handleSave},"save this"))}}]),a}(n.Component),k=(t(25),function(e){var a=e.label,t=e.value;return l.a.createElement("li",null,l.a.createElement("div",{className:"label"},a),l.a.createElement("div",{className:"value"},t))}),V=function(e){var a=e.data,t=e.id;return l.a.createElement("ul",null,a.map(function(e,a){var n=e.label,r=e.value,o="li-".concat(t,"-").concat(a);return l.a.createElement(k,{key:"li-".concat(o),label:n,value:r})}))},L=t(31),N=function(e){var a=e.label,t=e.value,n=e.ondelete;return l.a.createElement("li",null,l.a.createElement("div",{className:"state"},l.a.createElement(L.a,{className:"btn-sm btn-primary",style:{width:"100%"},to:t},a)),l.a.createElement("div",{className:"remove-state"},l.a.createElement("button",{className:"btn-sm btn-primary btn-warning",type:"submit",id:t,onClick:function(e){return function(e,a){e.preventDefault(),a(e.target.id)}(e,n)}},"delete")))},x=function(e){var a=e.data,t=e.ondelete,n=e.onselect;return a.map?l.a.createElement("ul",null,a.map(function(e,a){var r=e.projectName,o=e.id,c="li-".concat(o,"-").concat(a);return l.a.createElement(N,{ondelete:t,key:"li-".concat(c),label:r||"untitled",value:o,onselect:n})}),l.a.createElement("li",null,l.a.createElement("div",{className:"state",style:{width:"100%"}},l.a.createElement(L.a,{className:"btn-sm btn-primary",style:{width:"100%"},to:"/"},"create new")))):""},D=t(15),j=t.n(D),M=function(e,a){var t,n,l,r=e/100,o=j.a[a],c=0;if(!a)return 0;for(var i=0;i<o.length;i+=1){l=o[i].load||0,t=o[i].upto;var s=o[i].rate;if(n=i>0?o[i-1].upto:0,"end"===t)return c+=(r-n/100)*(s+l);if(e<=t)return c+=0===i?r*(s+l):(r-n/100)*(s+l);c+=(t-n)/100*(s+l)}return c},I=["Remortgage advance","Remortgage deposit","Remortgage fees","Money in","Money out","Money left in","Monthly rental","Monthly mortgage payment","MOE","Letting agent fees","Monthly free cashflow"],O=["Mortgage advance","Deposit","Stamp duty","Professional fees","Refurb/other costs","Total money in","Total cost"],w=["Sale price","Selling costs","Total input costs","Profit (before tax)","Gain(%)"],T=["Stress test","Minimum rent"],U=function(e,a,t,n,l,r,o){return e+a+t+n+l+M(r,o)+r},P={freeCash:function(e){var a=e.loanToValue,t=e.propertyValue,n=e.doneUpValue,l=e.mortgageInterestRatePercent,r=e.monthlyRent,o=e.moePercent,c=e.agentsPercent,i=e.refurbCost,s=e.otherCost,u=e.stampDutyType,d=e.remortgageFee,m=e.remortgageValuationFee,f=e.remortgageLegalFee,p=e.initMortgageFee,b=e.initLegalFee,v=e.initSurveyorsFee,y=e.repairingLease,h=a/100,g=Math.round(n*h),S=Math.round(n*(1-h)),F=Math.round(g*l/1200),C="yes"===y?0:r*o/100,E=r*c/100,R=r-("yes"===y?0:C)-F-E,k=d+m+f,V=p+b+v+(i+s)+M(t,u)+t,L=I;return[{label:L[0],value:g.toFixed(2)},{label:L[1],value:S.toFixed(2)},{label:L[2],value:k.toFixed(2)},{label:L[3],value:V.toFixed(2)},{label:L[4],value:(g-k).toFixed(2)},{label:L[5],value:(V-(g-k)).toFixed(2)},{label:L[6],value:r.toFixed(2)},{label:L[7],value:F.toFixed(2)},{label:L[8],value:C.toFixed(2)},{label:L[9],value:E.toFixed(2)},{label:L[10],value:R.toFixed(2)}]},initialFinance:function(e){var a=e.buyingCash,t=e.initialLoanToValue,n=e.propertyValue,l=e.initSurveyorsFee,r=e.initLegalFee,o=e.initMortgageFee,c=e.refurbCost,i=e.otherCost,s=e.stampDutyType,u="yes"===a,d=t/100,m=u?0:Math.round(n*d),f=l+r+o,p=c+i,b=u?n:Math.round(n*(1-d)),v=M(n,s),y=U(l,r,o,c,i,n,s),h=y-m,g=O;return[{label:g[0],value:m.toFixed(2)},{label:g[1],value:b.toFixed(2)},{label:g[2],value:v.toFixed(2)},{label:g[3],value:f.toFixed(2)},{label:g[4],value:p.toFixed(2)},{label:g[5],value:h.toFixed(2)},{label:g[6],value:y.toFixed(2)}]},flip:function(e){var a=e.sellingLegalFee,t=e.agentSellingFee,n=e.initSurveyorsFee,l=e.initLegalFee,r=e.initMortgageFee,o=e.refurbCost,c=e.otherCost,i=e.propertyValue,s=e.stampDutyType,u=e.doneUpValue,d=U(n,l,r,o,c,i,s),m=a+t,f=Math.round((u-d)/d*1e4)/100,p=f>=20?"green":"red",b=w;return[{label:b[0],value:u.toFixed(2)},{label:b[1],value:m.toFixed(2)},{label:b[2],value:d.toFixed(2)||"0"},{label:b[3],value:(u-(d+m)).toFixed(2)||"0",col:p},{label:b[4],value:f.toFixed(2)||0,col:p}]},allInputCosts:U,stressTest:function(e){var a=e.doneUpValue,t=e.monthlyRent,n=e.loanToValue,l=e.mortgageStressInterestRatePercent,r=e.mortgageStressMultipePercent,o=Math.ceil(a*n/100*l/1200*r/100),c=t>=o,i=T;return[{label:i[0],value:c?"pass":"fail"},{label:i[1],value:o.toFixed(2)}]},getCurrencyCode:function(e){return"ireland"===e.stampDutyType?8364:163}},W="http://192.168.0.12:3000/comparisons",B=function(e){function a(e){var t;return Object(s.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).state={data:{dealFinance:[],buyToLet:[],stress:[],flip:[]},fields:v.fields,currency:163,savedStates:{Items:[]},selectedState:a.setDefaultFormData()},t.doResults=t.doResults.bind(Object(m.a)(t)),t.calculate=t.calculate.bind(Object(m.a)(t)),t.saveState=t.saveState.bind(Object(m.a)(t)),t.deleteState=t.deleteState.bind(Object(m.a)(t)),t}return Object(p.a)(a,e),Object(f.a)(a,null,[{key:"findState",value:function(e,a){return e.Items.find(function(e){return e.id===a})}},{key:"setDefaultFormData",value:function(){var e={};return v.fields.map(function(a){return e[a.name]=a.defVal,!1}),e}},{key:"calc",value:function(e){var a=P.initialFinance(e),t=P.freeCash(e),n=P.flip(e);return{data:{dealFinance:a,buyToLet:t,stress:P.stressTest(e),flip:n},currency:P.getCurrencyCode(e)}}}]),Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.selectedStateId;this.getSavedStates(e||"")}},{key:"getSavedStates",value:function(e){var t=this;fetch(W).then(function(e){return e.json()}).then(function(n){var l;l=""!==e?a.findState(n,e):a.setDefaultFormData();var r=a.calc(l),o=r.data,c=r.currency;t.setState({data:o,currency:c,savedStates:n,selectedState:l})}).catch(function(){var e=a.setDefaultFormData(),n=a.calc(e),l=n.data,r=n.currency;t.setState({data:l,currency:r,savedStates:{Items:"No saved items avaialable"},selectedState:e})})}},{key:"calculate",value:function(e){this.setState(a.calc(e))}},{key:"doResults",value:function(){var e=this.state.data,a=e.dealFinance,t=e.buyToLet,n=e.stress,r=e.flip;return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Deal finance"),l.a.createElement(V,{id:"1",data:a})),l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Buy to let"),l.a.createElement(V,{id:"2",data:t})),l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Stress test"),l.a.createElement(V,{id:"3",data:n})),l.a.createElement("div",{className:"res-block"},l.a.createElement("h4",null,"Flip"),l.a.createElement(V,{id:"4",data:r})))}},{key:"saveState",value:function(e){var a=this;fetch(W,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.json()}).then(function(){a.getSavedStates()}).catch(function(){return a.setState({savedStates:{Items:"No save service avaialable"}})})}},{key:"deleteState",value:function(e){var a=this;fetch(W,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(function(e){if(!e.ok)throw new Error("delete failed");a.getSavedStates()}).catch(function(){return a.setState({savedStates:{Items:"No delete service avaialable"}})})}},{key:"render",value:function(){var e=this.state,a=e.currency,t=e.savedStates,n=e.selectedState,r=t.Items,o=l.a.createElement("div",{className:"column states"},l.a.createElement(x,{data:r,ondelete:this.deleteState})),c=r?o:"";return l.a.createElement("div",{className:"App"},l.a.createElement("div",{className:"column"},l.a.createElement(R,{name:"propcalc",fields:v.fields,formData:n,twocols:"yes",calculate:this.calculate,currsymbol:a,onsave:this.saveState})),l.a.createElement("div",{className:"column results"},this.doResults()),c)}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.selectedStateId,l=t.savedStates,r=a.findState(l,n)||a.setDefaultFormData();if(l.Items.length>0){var o=a.calc(r);return{data:o.data,currency:o.currency,selectedState:r}}return null}}]),a}(n.Component);var A=function(){return l.a.createElement(c.a,null,l.a.createElement("div",null,l.a.createElement(i.a,{exact:!0,path:"/",component:B}),l.a.createElement(i.a,{path:"/:id",render:function(e){return l.a.createElement(B,{selectedStateId:e.match.params.id})}})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(29);o.a.render(l.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},6:function(e,a){var t=String.fromCharCode(37),n=[{label:"Project name",name:"projectName",type:"text"},{label:"Purchase price(".concat("##CURR##",")"),name:"propertyValue",type:"number",defVal:0},{label:"Done up value(".concat("##CURR##",")"),name:"doneUpValue",type:"number",defVal:0},{label:"Monthly rent(".concat("##CURR##",")"),name:"monthlyRent",type:"number",defVal:0},{label:"Initial LTV(".concat(t,")"),name:"initialLoanToValue",type:"number",defVal:75},{label:"Cash purchase",name:"buyingCash",type:"checkbox",defVal:"no"},{label:"Surveyors fee(".concat("##CURR##",")"),name:"initSurveyorsFee",type:"number",defVal:600},{label:"Mortgage fee(".concat("##CURR##",")"),name:"initMortgageFee",type:"number",defVal:0},{label:"Legal fees(".concat("##CURR##",")"),name:"initLegalFee",type:"number",defVal:1500},{label:"Stamp duty",name:"stampDutyType",type:"select",options:[{value:"residential",name:"Residential Eng/NI"},{value:"commercial",name:"Commercial Eng/NI"},{value:"residentialWales",name:"Residential Wales"},{value:"commercialWales",name:"Commercial Wales"},{value:"residentialScotland",name:"Residential Scotland"},{value:"commercialScotland",name:"Commercial Scotland"},{value:"ireland",name:"Ireland"}],defVal:"residential"},{label:"Refurbishment cost(".concat("##CURR##",")"),name:"refurbCost",type:"number",defVal:0},{label:"Other cost(".concat("##CURR##",")"),name:"otherCost",type:"number",defVal:0},{label:"Remortgage fee(".concat("##CURR##",")"),name:"remortgageFee",type:"number",defVal:0},{label:"Remortgage valuation fee(".concat("##CURR##",")"),name:"remortgageValuationFee",type:"number",defVal:0},{label:"Remortgage legal fees(".concat("##CURR##",")"),name:"remortgageLegalFee",type:"number",defVal:0},{label:"Letting agents rate(".concat(t,")"),name:"agentsPercent",type:"number",defVal:10},{label:"\n    MOE rate(".concat(t,")"),name:"moePercent",type:"number",defVal:15},{label:"Repairing lease",name:"repairingLease",type:"checkbox",defVal:"no"},{label:"Interest rate(".concat(t,")"),name:"mortgageInterestRatePercent",type:"number",defVal:6},{label:"Remortgage LTV(".concat(t,")"),name:"loanToValue",type:"number",defVal:75},{label:"Solicitors selling fee(".concat("##CURR##",")"),name:"sellingLegalFee",type:"number",defVal:0},{label:"Agent/selling fee(".concat("##CURR##",")"),name:"agentSellingFee",type:"number",defVal:0},{label:"Mortgage stress test(".concat(t,")"),name:"mortgageStressMultipePercent",type:"number",defVal:125},{label:"Stress interest rate(".concat(t,")"),name:"mortgageStressInterestRatePercent",type:"number",defVal:5}];e.exports={fields:n,currencyPlaceholder:"##CURR##"}}},[[19,1,2]]]);
//# sourceMappingURL=main.0da5cf58.chunk.js.map